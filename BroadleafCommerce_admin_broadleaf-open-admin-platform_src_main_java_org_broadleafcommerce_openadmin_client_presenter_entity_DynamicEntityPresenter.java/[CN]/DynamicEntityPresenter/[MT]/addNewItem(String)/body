{
  initialValues.put("_type",new String[]{((DynamicEntityDataSource)display.getListDisplay().getGrid().getDataSource()).getDefaultNewEntityFullyQualifiedClassname()});
  compileDefaultValuesFromCurrentFilter(initialValues);
  BLCMain.ENTITY_ADD.editNewRecord(newItemTitle,(DynamicEntityDataSource)display.getListDisplay().getGrid().getDataSource(),initialValues,new ItemEditedHandler(){
    public void onItemEdited(    ItemEdited event){
      ListGridRecord[] recordList=new ListGridRecord[]{event.getRecord()};
      DSResponse updateResponse=new DSResponse();
      updateResponse.setData(recordList);
      getDisplay().getListDisplay().getGrid().getDataSource().updateCaches(updateResponse);
      getDisplay().getListDisplay().getGrid().deselectAllRecords();
      getDisplay().getListDisplay().getGrid().selectRecord(getDisplay().getListDisplay().getGrid().getRecordIndex(event.getRecord()));
      String primaryKey=display.getListDisplay().getGrid().getDataSource().getPrimaryKeyFieldName();
      ResultSet results=display.getListDisplay().getGrid().getResultSet();
      boolean foundRecord=false;
      if (results != null) {
        foundRecord=getDisplay().getListDisplay().getGrid().getResultSet().find(primaryKey,event.getRecord().getAttribute(primaryKey)) != null;
      }
      if (!foundRecord) {
        ((AbstractDynamicDataSource)getDisplay().getListDisplay().getGrid().getDataSource()).setAddedRecord(event.getRecord());
        getDisplay().getListDisplay().getGrid().getDataSource().fetchData(new Criteria("blc.fetch.from.cache",event.getRecord().getAttribute(primaryKey)),new DSCallback(){
          @Override public void execute(          DSResponse response,          Object rawData,          DSRequest request){
            getDisplay().getListDisplay().getGrid().setData(response.getData());
            getDisplay().getListDisplay().getGrid().selectRecord(0);
          }
        }
);
      }
    }
  }
,null,null);
}
