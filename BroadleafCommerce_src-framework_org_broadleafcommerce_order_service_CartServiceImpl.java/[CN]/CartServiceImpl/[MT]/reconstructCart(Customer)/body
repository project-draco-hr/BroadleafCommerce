{
  ReconstructCartResponse reconstructCartResponse=new ReconstructCartResponse();
  Order customerCart=findCartForCustomer(customer);
  if (customerCart != null) {
    for (    OrderItem orderItem : customerCart.getOrderItems()) {
      if (orderItem instanceof DiscreteOrderItem) {
        DiscreteOrderItem discreteOrderItem=(DiscreteOrderItem)orderItem;
        if (!discreteOrderItem.getSku().isActive(discreteOrderItem.getProduct(),orderItem.getCategory())) {
          reconstructCartResponse.getRemovedItems().add(orderItem);
          removeItemFromOrder(customerCart,discreteOrderItem);
        }
      }
 else       if (orderItem instanceof BundleOrderItem) {
        BundleOrderItem bundleOrderItem=(BundleOrderItem)orderItem;
        boolean removeBundle=false;
        for (        DiscreteOrderItem discreteOrderItem : bundleOrderItem.getDiscreteOrderItems()) {
          if (!discreteOrderItem.getSku().isActive(discreteOrderItem.getProduct(),orderItem.getCategory())) {
            removeBundle=true;
            break;
          }
        }
        if (removeBundle) {
          reconstructCartResponse.getRemovedItems().add(orderItem);
          removeItemFromOrder(customerCart,bundleOrderItem);
        }
      }
    }
  }
  reconstructCartResponse.setOrder(customerCart);
  return reconstructCartResponse;
}
