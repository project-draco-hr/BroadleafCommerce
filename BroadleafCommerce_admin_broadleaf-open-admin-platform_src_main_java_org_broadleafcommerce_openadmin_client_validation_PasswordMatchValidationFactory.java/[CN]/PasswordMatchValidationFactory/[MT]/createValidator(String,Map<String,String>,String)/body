{
  Object response=factory.newInstance(validatorClassname);
  if (response == null) {
    throw new RuntimeException("Unable to instantiate the item from the Factory using classname: (" + validatorClassname + "). Are you sure this classname is correct?");
  }
  MatchesFieldValidator valid=(MatchesFieldValidator)response;
  if (configurationItems.containsKey("errorMessageKey")) {
    String message=null;
    try {
      message=BLCMain.getMessageManager().getString(configurationItems.get("errorMessageKey"));
    }
 catch (    MissingResourceException e) {
    }
    if (message != null) {
      valid.setErrorMessage(message);
    }
  }
 else   if (configurationItems.containsKey("errorMessage")) {
    valid.setErrorMessage(configurationItems.get("errorMessage"));
  }
  valid.setOtherField(fieldName + "Repeat_blc");
  return valid;
}
