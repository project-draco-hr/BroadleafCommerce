{
  initializeProviders();
  Type lookupType=getLookupType(type,genericType);
  if (getApiWrapper(type,lookupType) != null) {
    genericType=getApiWrapper(type,lookupType);
  }
  if (mediaType.isCompatible(MediaType.APPLICATION_JSON_TYPE)) {
    if (Collection.class.isAssignableFrom(type)) {
      return jsonListProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
 else {
      return jsonRootElementProvider.readFrom((Class)genericType,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
  }
 else   if (mediaType.isCompatible(MediaType.APPLICATION_XML_TYPE) || mediaType.isCompatible(MediaType.TEXT_XML_TYPE)) {
    if (Collection.class.isAssignableFrom(type)) {
      return xmlListProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
 else {
      return xmlRootElementProvider.readFrom((Class)genericType,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
  }
  return null;
}
