{
  String identifier=buildIdentifier(orderItem,extraIdentifier,includePrice);
  Object[] gatheredOrderItem=gatheredItem.get(identifier);
  if (gatheredOrderItem == null) {
    gatheredItem.put(identifier,new Object[]{orderItem,fgItem});
    return;
  }
  for (  OrderMultishipOption option : options) {
    if (option.getOrderItem().getId().equals(orderItem.getId())) {
      option.setOrderItem((OrderItem)gatheredOrderItem[0]);
      orderMultishipOptionService.save(option);
    }
  }
  ((FulfillmentGroupItem)gatheredOrderItem[1]).setQuantity(((FulfillmentGroupItem)gatheredOrderItem[1]).getQuantity() + fgItem.getQuantity());
  if (!((OrderItem)gatheredOrderItem[0]).getId().equals(orderItem.getId())) {
    ((OrderItem)gatheredOrderItem[0]).setQuantity(((OrderItem)gatheredOrderItem[0]).getQuantity() + fgItem.getQuantity());
    itemsToRemove.add(orderItem);
  }
  fgItemsToRemove.add(fgItem);
}
