{
  Map<String,FieldMetadata> mergedProperties=filterOutCollectionMetadata(mergedUnfilteredProperties);
  BaseCtoConverter ctoConverter=(BaseCtoConverter)applicationContext.getBean("blBaseCtoConverter");
  if (criterionProviders != null) {
    ctoConverter.setFilterCriterionProviders(criterionProviders);
  }
  for (  String propertyId : cto.getPropertyIdSet()) {
    if (mergedProperties.containsKey(propertyId)) {
      boolean handled=false;
      for (      FieldPersistenceProvider fieldPersistenceProvider : fieldPersistenceProviders) {
        FieldProviderResponse response=fieldPersistenceProvider.addSearchMapping(new AddSearchMappingRequest(persistencePerspective,cto,ceilingEntityFullyQualifiedClassname,mergedProperties,propertyId,getFieldManager(),this),ctoConverter);
        if (FieldProviderResponse.NOT_HANDLED != response) {
          handled=true;
        }
        if (FieldProviderResponse.HANDLED_BREAK == response) {
          break;
        }
      }
      if (!handled) {
        defaultFieldPersistenceProvider.addSearchMapping(new AddSearchMappingRequest(persistencePerspective,cto,ceilingEntityFullyQualifiedClassname,mergedProperties,propertyId,getFieldManager(),this),ctoConverter);
      }
    }
 else {
      ctoConverter.addEmptyMapping(ceilingEntityFullyQualifiedClassname,propertyId);
    }
  }
  if (cto.getPropertyIdSet().isEmpty()) {
    ctoConverter.addEmptyMapping(ceilingEntityFullyQualifiedClassname,"");
  }
  return ctoConverter;
}
