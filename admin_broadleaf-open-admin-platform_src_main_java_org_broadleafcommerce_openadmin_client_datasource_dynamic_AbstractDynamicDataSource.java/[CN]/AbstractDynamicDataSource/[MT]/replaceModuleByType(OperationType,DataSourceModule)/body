{
  List<DataSourceModule> moduleList=new ArrayList<DataSourceModule>(modules.length);
  boolean moduleAdded=false;
  for (  DataSourceModule existingModule : modules) {
    if (existingModule.isCompatible(type) && !moduleAdded) {
      moduleList.add(module);
      module.setDataSource(this);
    }
 else {
      moduleList.add(existingModule);
    }
  }
  modules=moduleList.toArray(modules);
}
