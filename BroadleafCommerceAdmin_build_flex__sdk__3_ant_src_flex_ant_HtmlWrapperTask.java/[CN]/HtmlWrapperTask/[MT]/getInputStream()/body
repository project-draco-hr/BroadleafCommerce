{
  InputStream inputStream=null;
switch (template) {
case CLIENT_SIDE_DETECTION:
{
      if (history) {
        inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[0] + WITH_HISTORY+ INDEX_TEMPLATE_HTML);
        outputResources(TEMPLATE_DIR + templates[0] + WITH_HISTORY,new String[]{AC_OETAGS_JS,HISTORY_FRAME_HTML,HISTORY_JS,HISTORY_CSS});
      }
 else {
        inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[0] + "/"+ INDEX_TEMPLATE_HTML);
        outputResources(TEMPLATE_DIR + templates[0] + "/",new String[]{AC_OETAGS_JS});
      }
      break;
    }
case EXPRESS_INSTALLATION:
default :
{
    if (history) {
      inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[1] + WITH_HISTORY+ INDEX_TEMPLATE_HTML);
      outputResources(TEMPLATE_DIR + templates[1] + WITH_HISTORY,new String[]{AC_OETAGS_JS,HISTORY_FRAME_HTML,HISTORY_JS,HISTORY_CSS,PLAYERPRODUCTINSTALL_SWF});
    }
 else {
      inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[1] + "/"+ INDEX_TEMPLATE_HTML);
      outputResources(TEMPLATE_DIR + templates[1] + "/",new String[]{AC_OETAGS_JS,PLAYERPRODUCTINSTALL_SWF});
    }
    break;
  }
case NO_PLAYER_DETECTION:
{
  if (history) {
    inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[2] + WITH_HISTORY+ INDEX_TEMPLATE_HTML);
    outputResources(TEMPLATE_DIR + templates[2] + WITH_HISTORY,new String[]{AC_OETAGS_JS,HISTORY_FRAME_HTML,HISTORY_JS,HISTORY_CSS});
  }
 else {
    inputStream=getClass().getResourceAsStream(TEMPLATE_DIR + templates[2] + "/"+ INDEX_TEMPLATE_HTML);
    outputResources(TEMPLATE_DIR + templates[2] + "/",new String[]{AC_OETAGS_JS});
  }
  break;
}
}
return inputStream;
}
