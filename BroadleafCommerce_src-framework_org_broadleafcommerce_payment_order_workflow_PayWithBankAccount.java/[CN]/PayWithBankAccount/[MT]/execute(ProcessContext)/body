{
  BankAccountModule module=bankAccountService.getBankAccountModuleByName(bankAccountModuleName);
  CombinedPaymentContextSeed seed=((PaymentContext)context).getSeedData();
  Map<PaymentInfo,Referenced> infos=seed.getInfos();
  Iterator<PaymentInfo> itr=infos.keySet().iterator();
  while (itr.hasNext()) {
    PaymentInfo info=itr.next();
    if (info.getType().equals(PaymentInfoType.CREDIT_CARD)) {
      if (seed.getActionType() == PaymentActionType.AUTHORIZE) {
        module.authorize(info,(BankAccountPaymentInfo)infos.get(info));
      }
 else       if (seed.getActionType() == PaymentActionType.DEBIT) {
        module.debit(info,(BankAccountPaymentInfo)infos.get(info));
      }
 else {
        module.authorizeAndDebit(info,(BankAccountPaymentInfo)infos.get(info));
      }
    }
  }
  return context;
}
