{
  User user=(User)command;
  if (userService.readUserByUsername(user.getUsername()) != null) {
    errors.rejectValue("username","username.used",null,null);
  }
  userService.readUserByUsername(user.getUsername());
  ModelAndView mav=new ModelAndView(getSuccessView(),errors.getModel());
  if (errors.hasErrors()) {
    logger.debug("Error returning back to the form");
    return showForm(request,response,errors);
  }
  userService.registerUser(user);
  mav.addObject("saved",true);
  return mav;
}
