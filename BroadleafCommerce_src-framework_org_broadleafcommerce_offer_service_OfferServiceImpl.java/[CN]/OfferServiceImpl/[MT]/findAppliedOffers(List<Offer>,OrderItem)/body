{
  List<OfferAudit> foundOffers=new ArrayList<OfferAudit>();
  for (  Offer candOffer : candidateOffers) {
    if (candOffer.isStackable()) {
      foundOffers.add(createOfferAuditFromOffer(candOffer,orderItem));
    }
 else     if (foundOffers.size() > 0) {
      for (      OfferAudit appOfferAudit : foundOffers) {
        Offer appOffer=appOfferAudit.getOffer();
        if (!appOffer.isStackable()) {
          if (!(appOffer.getPriority() == candOffer.getPriority())) {
            if (isCandOfferHasPriorityOverAppOffer(appOffer,candOffer)) {
              foundOffers.remove(appOfferAudit);
              foundOffers.add(createOfferAuditFromOffer(candOffer,orderItem));
            }
          }
 else {
            if (isCandOfferGreaterThanAppOffer(candOffer,appOffer,orderItem.getRetailPrice())) {
              foundOffers.remove(appOfferAudit);
              foundOffers.add(createOfferAuditFromOffer(candOffer,orderItem));
            }
          }
        }
      }
    }
 else {
      foundOffers.add(createOfferAuditFromOffer(candOffer,orderItem));
    }
  }
  return foundOffers;
}
