{
  BigDecimal numTimesToApply=new BigDecimal(Math.min(numApplicationsNeeded,orderItem.getQuantity()));
  Money oldOrderAdjustment=orderItem.getProratedOrderAdjustment();
  Money changeToAdjustment=unitAmount.multiply(numTimesToApply);
  orderItem.setProratedOrderAdjustment(oldOrderAdjustment.add(changeToAdjustment));
  return numTimesToApply.longValue();
}
