{
  CouponCode couponCode=(CouponCode)command;
  Double price=Double.valueOf(request.getParameter("orderTotal"));
  BroadleafOrder broadleafOrder=new BroadleafOrder();
  broadleafOrder.setOrderTotal(price);
  WorkingMemory workingMemory=ruleBaseService.getRuleBase().newStatefulSession();
  workingMemory.insert(broadleafOrder);
  workingMemory.insert(couponCode);
  workingMemory.fireAllRules();
  if (errors.hasErrors()) {
    logger.debug("Error returning back to the form");
    return showForm(request,response,errors);
  }
  ModelAndView mav=new ModelAndView(getSuccessView(),errors.getModel());
  mav.addObject("saved",true);
  return mav;
}
