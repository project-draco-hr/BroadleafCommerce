{
  if (offer != null && orderItem != null) {
    Money adjustmentPrice=orderItem.getAdjustmentPrice();
    if (adjustmentPrice == null) {
      adjustmentPrice=orderItem.getRetailPrice();
    }
    if (offer.getDiscountType() == OfferDiscountType.AMOUNT_OFF) {
      value=offer.getValue().getAmount();
    }
    if (offer.getDiscountType() == OfferDiscountType.FIX_PRICE) {
      value=adjustmentPrice.subtract(offer.getValue()).getAmount();
    }
    if (offer.getDiscountType() == OfferDiscountType.PERCENT_OFF) {
      value=adjustmentPrice.multiply(offer.getValue().divide(new BigDecimal("100")).getAmount()).getAmount();
    }
    if (adjustmentPrice.lessThan(value)) {
      value=adjustmentPrice.getAmount();
    }
  }
}
