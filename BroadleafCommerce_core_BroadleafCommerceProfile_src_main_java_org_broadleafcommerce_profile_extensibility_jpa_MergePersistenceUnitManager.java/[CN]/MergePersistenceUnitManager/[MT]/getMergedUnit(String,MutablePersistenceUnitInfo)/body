{
  if (!mergedPus.containsKey(persistenceUnitName)) {
    PersistenceUnitInfo puiToStore=newPU;
    if (jpa2ApiPresent) {
      puiToStore=(PersistenceUnitInfo)Proxy.newProxyInstance(SmartPersistenceUnitInfo.class.getClassLoader(),new Class[]{SmartPersistenceUnitInfo.class},new Jpa2PersistenceUnitInfoDecorator(newPU));
    }
    for (    BroadleafClassTransformer transformer : classTransformers) {
      try {
        puiToStore.addTransformer(transformer);
      }
 catch (      IllegalStateException e) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Spring reported that a LoadTimeWeaver is not registered. As a result, the Broadleaf Commerce SingleTableInheritanceClassTransformer is not being registered with the persistence unit. This is only impactful if you are trying to provide SingleTable inheritance strategy overrides for Broadleaf Commerce entity hierarchies.");
        }
      }
    }
    mergedPus.put(persistenceUnitName,puiToStore);
  }
  return mergedPus.get(persistenceUnitName);
}
