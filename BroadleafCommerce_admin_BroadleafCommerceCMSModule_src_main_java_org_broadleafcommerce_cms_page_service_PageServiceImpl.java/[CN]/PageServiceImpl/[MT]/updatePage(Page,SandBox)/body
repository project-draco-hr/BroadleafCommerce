{
  if (page.getLockedFlag()) {
    throw new IllegalArgumentException("Unable to update a locked record");
  }
  if (checkForSandboxMatch(page.getSandbox(),destSandbox)) {
    return pageDao.updatePage(page,true);
  }
 else   if (isProductionSandBox(page.getSandbox())) {
    page.setLockedFlag(true);
    page=pageDao.updatePage(page,false);
    Page clonedPage=page.cloneEntity();
    clonedPage.setOriginalPageId(page.getId());
    clonedPage.setSandbox(destSandbox);
    Page returnPage=pageDao.addPage(clonedPage);
    sandBoxItemDao.addSandBoxItem(destSandbox,SandBoxOperationType.UPDATE,SandBoxItemType.PAGE,clonedPage.getFullUrl(),returnPage.getId(),returnPage.getOriginalPageId());
    return returnPage;
  }
 else {
    throw new IllegalArgumentException("Update called when promote or reject was expected.");
  }
}
