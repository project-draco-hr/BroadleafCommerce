{
  document.addField(shs.getNamespaceFieldName(),shs.getCurrentNamespace());
  document.addField(shs.getIdFieldName(),shs.getSolrDocumentId(document,product));
  document.addField(shs.getProductIdFieldName(),product.getId());
  for (  CategoryProductXref categoryXref : product.getAllParentCategoryXrefs()) {
    document.addField(shs.getExplicitCategoryFieldName(),categoryXref.getCategory().getId());
    String categorySortFieldName=shs.getCategorySortFieldName(categoryXref.getCategory());
    int index=-1;
    int count=0;
    for (    CategoryProductXref productXref : categoryXref.getCategory().getAllProductXrefs()) {
      if (productXref.getProduct().equals(product)) {
        index=count;
        break;
      }
      count++;
    }
    document.addField(categorySortFieldName,index);
  }
  Set<Category> fullCategoryHierarchy=new HashSet<Category>();
  for (  CategoryProductXref categoryXref : product.getAllParentCategoryXrefs()) {
    fullCategoryHierarchy.addAll(categoryXref.getCategory().buildFullCategoryHierarchy(null));
  }
  for (  Category category : fullCategoryHierarchy) {
    document.addField(shs.getCategoryFieldName(),category.getId());
  }
}
