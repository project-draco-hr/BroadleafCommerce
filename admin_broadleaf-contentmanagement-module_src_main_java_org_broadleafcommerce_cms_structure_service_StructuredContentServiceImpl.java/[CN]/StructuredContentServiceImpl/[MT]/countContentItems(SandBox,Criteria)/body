{
  c.add(Restrictions.eq("archivedFlag",false));
  c.setProjection(Projections.rowCount());
  if (sandbox == null) {
    c.add(Restrictions.isNull("sandbox"));
    return (Long)c.uniqueResult();
  }
 else   if (SandBoxType.PRODUCTION.equals(sandbox.getSandBoxType())) {
    c.add(Restrictions.eq("sandbox",sandbox));
    return (Long)c.uniqueResult();
  }
 else {
    Criterion originalSandboxExpression=Restrictions.eq("originalSandBox",sandbox);
    Criterion currentSandboxExpression=Restrictions.eq("sandbox",sandbox);
    Criterion productionSandboxExpression;
    if (sandbox.getSite() == null || sandbox.getSite().getProductionSandbox() == null) {
      productionSandboxExpression=Restrictions.isNull("sandbox");
    }
 else {
      if (sandbox.getId().equals(sandbox.getSite().getProductionSandbox().getId())) {
        return (Long)c.uniqueResult();
      }
      productionSandboxExpression=Restrictions.eq("sandbox",sandbox.getSite().getProductionSandbox());
    }
    c.add(Restrictions.or(Restrictions.or(currentSandboxExpression,productionSandboxExpression),originalSandboxExpression));
    Long resultCount=(Long)c.list().get(0);
    Long updatedCount=0L;
    Long deletedCount=0L;
    c.add(Restrictions.and(Restrictions.isNotNull("originalItemId"),Restrictions.or(currentSandboxExpression,originalSandboxExpression)));
    updatedCount=(Long)c.list().get(0);
    c.add(Restrictions.and(Restrictions.eq("deletedFlag",true),Restrictions.or(currentSandboxExpression,originalSandboxExpression)));
    deletedCount=(Long)c.list().get(0);
    return resultCount - updatedCount - deletedCount;
  }
}
