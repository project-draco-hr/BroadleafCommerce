{
  if (sandboxList == null || sandboxList.size() == 0) {
    return productionList;
  }
  Map<Long,StructuredContentDTO> scMap=new LinkedHashMap<Long,StructuredContentDTO>();
  if (productionList != null) {
    for (    StructuredContentDTO sc : productionList) {
      scMap.put(sc.getId(),sc);
    }
  }
  for (  StructuredContent sc : sandboxList) {
    if (sc.getOriginalItemId() != null) {
      scMap.remove(sc.getOriginalItemId());
    }
    if (!sc.getDeletedFlag() && !sc.getOfflineFlag()) {
      StructuredContentDTO convertedItem=buildStructuredContentDTO(sc,secure);
      scMap.put(sc.getId(),convertedItem);
    }
  }
  ArrayList<StructuredContentDTO> returnList=new ArrayList<StructuredContentDTO>(scMap.values());
  if (returnList.size() > 1) {
    Collections.sort(returnList,new BeanComparator("priority"));
  }
  return returnList;
}
