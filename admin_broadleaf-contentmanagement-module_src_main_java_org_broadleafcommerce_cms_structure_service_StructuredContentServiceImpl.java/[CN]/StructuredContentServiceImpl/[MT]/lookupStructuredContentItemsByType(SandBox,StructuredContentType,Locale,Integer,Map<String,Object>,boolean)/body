{
  List<StructuredContent> sandBoxContentList=null;
  String cacheKey=buildTypeKey(getProductionSandBox(sandBox),locale,contentType.getName());
  cacheKey=cacheKey + "-" + secure;
  List<StructuredContentDTO> productionContentDTOList=getStructuredContentListFromCache(cacheKey);
  if (productionContentDTOList == null) {
    List<StructuredContent> productionContentList=structuredContentDao.findActiveStructuredContentByType(getProductionSandBox(sandBox),contentType,locale);
    productionContentDTOList=buildStructuredContentDTOList(productionContentList,secure);
    if (productionContentDTOList != null) {
      addStructuredContentListToCache(cacheKey,productionContentDTOList);
    }
  }
  final List<StructuredContentDTO> contentList;
  if (!isProductionSandBox(sandBox)) {
    sandBoxContentList=structuredContentDao.findActiveStructuredContentByType(sandBox,contentType,locale);
    contentList=mergeContent(productionContentDTOList,sandBoxContentList,secure);
  }
 else {
    contentList=productionContentDTOList;
  }
  return evaluateAndPriortizeContent(contentList,count,ruleDTOs);
}
