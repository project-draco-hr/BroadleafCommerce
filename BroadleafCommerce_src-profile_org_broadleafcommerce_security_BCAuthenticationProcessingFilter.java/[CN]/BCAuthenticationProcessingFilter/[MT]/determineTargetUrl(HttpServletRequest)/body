{
  Authentication auth=SecurityContextHolder.getContext().getAuthentication();
  for (  GrantedAuthority ga : auth.getAuthorities()) {
    if ("ROLE_PASSWORD_CHANGE_REQUIRED".equals(ga.getAuthority())) {
      return passwordChangeUri;
    }
  }
  String sessionUrl=(String)request.getSession().getAttribute(BC_LOGIN_SUCCESS_URL_KEY);
  if (sessionUrl != null) {
    removeLoginSuccessUrl(request);
    return sessionUrl;
  }
  return super.determineTargetUrl(request);
}
