{
  Authentication auth=SecurityContextHolder.getContext().getAuthentication();
  for (  GrantedAuthority ga : auth.getAuthorities()) {
    if ("ROLE_PASSWORD_CHANGE_REQUIRED".equals(ga.getAuthority())) {
      return passwordChangeUri;
    }
  }
  return super.determineTargetUrl(request);
}
