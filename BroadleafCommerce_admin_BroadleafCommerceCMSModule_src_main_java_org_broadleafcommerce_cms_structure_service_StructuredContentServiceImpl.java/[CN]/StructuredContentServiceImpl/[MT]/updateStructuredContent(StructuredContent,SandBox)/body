{
  if (content.getLockedFlag()) {
    throw new IllegalArgumentException("Unable to update a locked record");
  }
  if (checkForSandboxMatch(content.getSandbox(),destSandbox)) {
    return structuredContentDao.addOrUpdateContentItem(content);
  }
 else   if (checkForProductionSandbox(content.getSandbox())) {
    StructuredContent clonedContent=content.cloneEntity();
    clonedContent.setOriginalItemId(content.getId());
    clonedContent.setSandbox(destSandbox);
    structuredContentDao.detach(content);
    StructuredContent returnContent=structuredContentDao.addOrUpdateContentItem(clonedContent);
    StructuredContent prod=findStructuredContentById(content.getId());
    prod.setLockedFlag(true);
    prod=structuredContentDao.addOrUpdateContentItem(prod);
    SandBoxOperationType type=SandBoxOperationType.UPDATE;
    if (clonedContent.getDeletedFlag()) {
      type=SandBoxOperationType.DELETE;
    }
    sandBoxItemDao.addSandBoxItem(destSandbox,type,SandBoxItemType.STRUCTURED_CONTENT,returnContent.getContentName(),returnContent.getId(),returnContent.getOriginalItemId());
    return returnContent;
  }
 else {
    throw new IllegalArgumentException("Update called when promote or reject was expected.");
  }
}
