{
  BLCMain.NON_MODAL_PROGRESS.startProgress();
  JavaScriptObject data=request.getData();
  final TreeNode record=new TreeNode(data);
  Entity entity=buildEntity(record,request);
  service.update(new PersistencePackage(ceilingEntityFullyQualifiedClassname,entity,persistencePerspective,null,BLCMain.csrfToken),new EntityServiceAsyncCallback<Entity>(EntityOperationType.UPDATE,requestId,request,response,dataSource){
    public void onSuccess(    Entity result){
      super.onSuccess(result);
      String realStartingId=dataSource.stripDuplicateAllowSpecialCharacters(dataSource.getPrimaryKeyValue(record));
      String embellishedStartingId=dataSource.getPrimaryKeyValue(record);
      RecordList resultSet=((PresentationLayerAssociatedDataSource)dataSource).getAssociatedGrid().getRecordList();
      if (resultSet != null) {
        Record[] myRecords=resultSet.toArray();
        int count=1;
        for (        Record myRecord : myRecords) {
          String realMyId=dataSource.stripDuplicateAllowSpecialCharacters(dataSource.getPrimaryKeyValue(myRecord));
          String embellishedMyId=dataSource.getPrimaryKeyValue(myRecord);
          if (realStartingId.equals(realMyId) && !embellishedStartingId.equals(embellishedMyId)) {
            updateRecord(result,(TreeNode)myRecord,false);
            ((ListGrid)((PresentationLayerAssociatedDataSource)dataSource).getAssociatedGrid()).refreshRow(count);
          }
          count++;
        }
      }
      TreeNode[] recordList=new TreeNode[]{record};
      response.setData(recordList);
      dataSource.processResponse(requestId,response);
    }
  }
);
}
