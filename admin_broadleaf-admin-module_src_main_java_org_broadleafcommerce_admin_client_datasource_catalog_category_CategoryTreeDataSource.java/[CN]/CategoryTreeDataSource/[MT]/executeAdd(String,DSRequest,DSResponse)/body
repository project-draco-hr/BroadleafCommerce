{
  BLCMain.NON_MODAL_PROGRESS.startProgress();
  setLinkedValue(getPrimaryKeyValue(((ListGrid)getAssociatedGrid()).getSelectedRecord()));
  JavaScriptObject data=request.getData();
  final TreeNode newRecord=new TreeNode(data);
  final DataSourceModule entityModule=getCompatibleModule(OperationType.ENTITY);
  Entity entity=entityModule.buildEntity(newRecord,request);
  service.add(new PersistencePackage(entityModule.getCeilingEntityFullyQualifiedClassname(),entity,persistencePerspective,new String[]{"addNewCategory"},BLCMain.csrfToken),new EntityServiceAsyncCallback<Entity>(EntityOperationType.ADD,requestId,request,response,this){
    public void onSuccess(    Entity result){
      super.onSuccess(result);
      if (processResult(result,requestId,response,CategoryTreeDataSource.this)) {
        TreeNode record=(TreeNode)entityModule.buildRecord(result,true);
        TreeNode[] recordList=new TreeNode[]{record};
        response.setData(recordList);
        processResponse(requestId,response);
      }
    }
  }
);
}
