{
  String type=null;
  if (filename.contains(".js")) {
    type="js";
  }
 else   if (filename.contains(".css")) {
    type="css";
  }
 else {
    return originalResource;
  }
  byte[] minifiedBytes=null;
  try (BufferedReader in=new BufferedReader(new InputStreamReader(originalResource.getInputStream(),"utf-8"));ByteArrayOutputStream baos=new ByteArrayOutputStream();BufferedWriter out=new BufferedWriter(new OutputStreamWriter(baos,"utf-8"))){
    if ("js".equals(type)) {
      JavaScriptCompressor jsc=new JavaScriptCompressor(in,getLogBasedErrorReporter());
      jsc.compress(out,linebreak,munge,verbose,preserveAllSemiColons,disableOptimizations);
    }
 else     if ("css".equals(type)) {
      CssCompressor cssc=new CssCompressor(in);
      cssc.compress(out,100);
    }
    out.flush();
    minifiedBytes=baos.toByteArray();
  }
 catch (  Exception e) {
    LOG.warn("Could not minify resources, returned unminified bytes",e);
    return originalResource;
  }
  return new GeneratedResource(minifiedBytes,filename);
}
