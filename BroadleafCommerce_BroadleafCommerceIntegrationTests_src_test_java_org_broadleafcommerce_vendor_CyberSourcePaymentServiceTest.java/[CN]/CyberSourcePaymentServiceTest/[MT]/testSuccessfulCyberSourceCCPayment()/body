{
  if (serviceManager.getMerchantId().equals("?")) {
    return;
  }
  CyberSourceCardRequest cardRequest=new CyberSourceCardRequest();
  cardRequest.setTransactionType(CyberSourceTransactionType.AUTHORIZE);
  cardRequest.setServiceType(CyberSourceServiceType.PAYMENT);
  cardRequest.setMethodType(CyberSourceMethodType.CREDITCARD);
  cardRequest.setCurrency(Currency.getInstance(Locale.US).getCurrencyCode());
  CyberSourceBillingRequest billingRequest=new CyberSourceBillingRequest();
  billingRequest.setCity("Mountain View");
  billingRequest.setFirstName("John");
  billingRequest.setLastName("Doe");
  billingRequest.setPostalCode("94043");
  billingRequest.setIpAddress("10.7.111.111");
  billingRequest.setState("CA");
  billingRequest.setStreet1("1295 Charleston Road");
  billingRequest.setCountry("US");
  billingRequest.setEmail("null@cybersource.com");
  cardRequest.setBillingRequest(billingRequest);
  CyberSourceItemRequest itemRequest1=new CyberSourceItemRequest();
  itemRequest1.setDescription("First Item");
  itemRequest1.setId(1L);
  itemRequest1.setQuantity(2L);
  itemRequest1.setShortDescription("firstItem");
  itemRequest1.setUnitPrice(new Money(12.34));
  cardRequest.getItemRequests().add(itemRequest1);
  CyberSourceItemRequest itemRequest2=new CyberSourceItemRequest();
  itemRequest2.setDescription("Second Item");
  itemRequest2.setId(2L);
  itemRequest2.setQuantity(1L);
  itemRequest2.setShortDescription("secondItem");
  itemRequest2.setUnitPrice(new Money(56.78));
  cardRequest.getItemRequests().add(itemRequest2);
  cardRequest.setAccountNumber("4111111111111111");
  cardRequest.setExpirationMonth(12);
  cardRequest.setExpirationYear(2020);
  CyberSourcePaymentService service=(CyberSourcePaymentService)serviceManager.getValidService(cardRequest);
  CyberSourceCardResponse response=(CyberSourceCardResponse)service.process(cardRequest);
  assert(response.getAuthResponse().getAmount().doubleValue() > 0D);
  assert(response.getReasonCode().intValue() == 100);
  CyberSourceCardRequest cardRequest2=new CyberSourceCardRequest();
  cardRequest2.setTransactionType(CyberSourceTransactionType.CAPTURE);
  cardRequest2.setServiceType(CyberSourceServiceType.PAYMENT);
  cardRequest2.setMethodType(CyberSourceMethodType.CREDITCARD);
  cardRequest2.setCurrency(Currency.getInstance(Locale.US).getCurrencyCode());
  cardRequest2.setRequestID(response.getRequestID());
  cardRequest2.setRequestToken(response.getRequestToken());
  cardRequest2.getItemRequests().add(itemRequest1);
  cardRequest2.getItemRequests().add(itemRequest2);
  CyberSourceCardResponse response2=(CyberSourceCardResponse)service.process(cardRequest2);
  assert(response2.getReasonCode().intValue() == 100);
  cardRequest.setTransactionType(CyberSourceTransactionType.AUTHORIZEANDCAPTURE);
  CyberSourceCardResponse response3=(CyberSourceCardResponse)service.process(cardRequest);
  assert(response3.getAuthResponse().getAmount().doubleValue() > 0D);
  assert(response3.getCaptureResponse().getAmount().doubleValue() > 0D);
  assert(response3.getReasonCode().intValue() == 100);
  CyberSourceCardRequest cardRequest4=new CyberSourceCardRequest();
  cardRequest4.setTransactionType(CyberSourceTransactionType.CREDIT);
  cardRequest4.setServiceType(CyberSourceServiceType.PAYMENT);
  cardRequest4.setMethodType(CyberSourceMethodType.CREDITCARD);
  cardRequest4.setCurrency(Currency.getInstance(Locale.US).getCurrencyCode());
  cardRequest4.setRequestID(response3.getRequestID());
  cardRequest4.setRequestToken(response3.getRequestToken());
  cardRequest4.getItemRequests().add(itemRequest1);
  cardRequest4.getItemRequests().add(itemRequest2);
  CyberSourceCardResponse response4=(CyberSourceCardResponse)service.process(cardRequest4);
  assert(response4.getReasonCode().intValue() == 100);
  cardRequest.setTransactionType(CyberSourceTransactionType.AUTHORIZE);
  CyberSourceCardResponse response7=(CyberSourceCardResponse)service.process(cardRequest);
  CyberSourceCardRequest cardRequest7=new CyberSourceCardRequest();
  cardRequest7.setTransactionType(CyberSourceTransactionType.REVERSEAUTHORIZE);
  cardRequest7.setServiceType(CyberSourceServiceType.PAYMENT);
  cardRequest7.setMethodType(CyberSourceMethodType.CREDITCARD);
  cardRequest7.setCurrency(Currency.getInstance(Locale.US).getCurrencyCode());
  cardRequest7.setRequestID(response7.getRequestID());
  cardRequest7.setRequestToken(response7.getRequestToken());
  cardRequest7.getItemRequests().add(itemRequest1);
  cardRequest7.getItemRequests().add(itemRequest2);
  CyberSourceCardResponse response8=(CyberSourceCardResponse)service.process(cardRequest7);
  assert(response8.getReasonCode().intValue() == 100);
}
