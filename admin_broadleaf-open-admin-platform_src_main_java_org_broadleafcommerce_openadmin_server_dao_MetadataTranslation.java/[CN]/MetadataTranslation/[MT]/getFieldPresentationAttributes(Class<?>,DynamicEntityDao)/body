{
  Map<String,FieldMetadata> attributes=new HashMap<String,FieldMetadata>();
  Field[] fields=dynamicEntityDao.getAllFields(targetClass);
  for (  Field field : fields) {
    AdminPresentation annot=field.getAnnotation(AdminPresentation.class);
    AdminPresentationCollection annotColl=field.getAnnotation(AdminPresentationCollection.class);
    AdminPresentationAdornedTargetCollection adornedTargetCollection=field.getAnnotation(AdminPresentationAdornedTargetCollection.class);
    AdminPresentationMap map=field.getAnnotation(AdminPresentationMap.class);
    if (annot != null) {
      BasicFieldMetadataOverride override=constructBasicMetadataOverride(field);
      buildBasicMetadata(targetClass,attributes,field,override,dynamicEntityDao);
    }
 else     if (annotColl != null) {
      BasicCollectionMetadataOverride override=constructBasicCollectionMetadataOverride(field);
      buildCollectionMetadata(targetClass,attributes,field,override);
    }
 else     if (adornedTargetCollection != null) {
      AdornedTargetCollectionMetadataOverride override=constructAdornedTargetCollectionMetadataOverride(field);
      buildAdornedTargetCollectionMetadata(targetClass,attributes,field,override);
    }
 else     if (map != null) {
      MapMetadataOverride override=constructMapMetadataOverride(field);
      buildMapMetadata(targetClass,attributes,field,override,dynamicEntityDao);
    }
 else {
      BasicFieldMetadata metadata=new BasicFieldMetadata();
      metadata.setName(field.getName());
      metadata.setExcluded(false);
      attributes.put(field.getName(),metadata);
    }
  }
  return attributes;
}
