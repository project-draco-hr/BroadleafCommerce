{
  logPaymentStartEvent(paymentContext,TransactionType.AUTHORIZEANDDEBIT);
  PaymentResponseItem response=null;
  PaymentException paymentException=null;
  try {
    response=paymentModule.authorizeAndDebit(paymentContext);
  }
 catch (  PaymentException e) {
    if (e instanceof PaymentProcessorException) {
      response=((PaymentProcessorException)e).getPaymentResponseItem();
    }
    paymentException=e;
    throw e;
  }
 finally {
    logResponseItem(paymentContext,response,TransactionType.AUTHORIZEANDDEBIT);
    logPaymentFinishEvent(paymentContext,TransactionType.AUTHORIZEANDDEBIT,paymentException);
  }
  return response;
}
