{
  SolrInputDocument document=new SolrInputDocument();
  attachBasicDocumentFields(product,document);
  List<String> addedProperties=new ArrayList<String>();
  Map<String,List<String>> copyFieldValues=new HashMap<String,List<String>>();
  for (  Field field : fields) {
    try {
      if (field.getSearchable()) {
        for (        FieldType searchableFieldType : field.getSearchableFieldTypes()) {
          Map<String,Object> propertyValues=getPropertyValues(product,field,searchableFieldType,locales,priceLists);
          for (          Entry<String,Object> entry : propertyValues.entrySet()) {
            String prefix=entry.getKey() + "_";
            Object value=entry.getValue();
            String solrPropertyName=getPropertyNameForFieldSearchable(field,searchableFieldType,prefix);
            document.addField(solrPropertyName,value);
            addedProperties.add(solrPropertyName);
            List<String> copyFieldValue=copyFieldValues.get(prefix);
            if (copyFieldValue == null) {
              copyFieldValue=new ArrayList<String>();
              copyFieldValues.put(prefix,copyFieldValue);
            }
            copyFieldValue.add(value.toString());
          }
        }
      }
      FieldType facetFieldType=field.getFacetFieldType();
      if (facetFieldType != null) {
        Map<String,Object> propertyValues=getPropertyValues(product,field,facetFieldType,locales,priceLists);
        for (        Entry<String,Object> entry : propertyValues.entrySet()) {
          String prefix=entry.getKey() + "_";
          String solrFacetPropertyName=getPropertyNameForFieldFacet(field,prefix);
          if (!addedProperties.contains(solrFacetPropertyName)) {
            Object value=entry.getValue();
            document.addField(solrFacetPropertyName,value);
          }
        }
      }
    }
 catch (    Exception e) {
      LOG.trace("Could not get value for property[" + field.getQualifiedFieldName() + "] for product id["+ product.getId()+ "]");
    }
  }
  for (  Entry<String,List<String>> entry : copyFieldValues.entrySet()) {
    document.addField(getSearchableFieldName(entry.getKey()),StringUtils.join(entry.getValue()," "));
  }
  return document;
}
