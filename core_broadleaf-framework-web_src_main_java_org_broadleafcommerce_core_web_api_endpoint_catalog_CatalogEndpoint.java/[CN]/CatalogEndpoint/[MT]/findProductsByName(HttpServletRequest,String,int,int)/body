{
  List<Product> result;
  if (name == null) {
    result=catalogService.findAllProducts(limit,offset);
  }
 else {
    result=catalogService.findProductsByName(name,limit,offset);
  }
  List<ProductWrapper> out=new ArrayList<ProductWrapper>();
  if (result != null) {
    for (    Product product : result) {
      ProductWrapper wrapper;
      if (product instanceof ProductBundle) {
        wrapper=(ProductWrapper)context.getBean(ProductBundleWrapper.class.getName());
      }
 else {
        wrapper=(ProductWrapper)context.getBean(ProductWrapper.class.getName());
      }
      wrapper.wrap(product,request);
      out.add(wrapper);
    }
  }
  return out;
}
