{
  Boolean classAnnotatedPopulateManyToOneFields=null;
  for (int i=entities.length - 1; i >= 0; i--) {
    AdminPresentationClass adminPresentationClass=entities[i].getAnnotation(AdminPresentationClass.class);
    if (adminPresentationClass != null && adminPresentationClass.populateToOneFields() != PopulateToOneFieldsEnum.NOT_SPECIFIED) {
      classAnnotatedPopulateManyToOneFields=adminPresentationClass.populateToOneFields() == PopulateToOneFieldsEnum.TRUE;
      break;
    }
  }
  Map<String,FieldMetadata> mergedProperties=propertyBuilder.execute(classAnnotatedPopulateManyToOneFields);
  for (int i=entities.length - 1; i >= 0; i--) {
    boolean handled=false;
    for (    MetadataProvider metadataProvider : metadataProviders) {
      boolean response=metadataProvider.overrideViaAnnotation(new OverrideViaAnnotationRequest(entities[i],mergedProperties,isParentExcluded,dynamicEntityDao,prefix));
      if (response) {
        handled=true;
      }
    }
    if (!handled) {
      defaultMetadataProvider.overrideViaAnnotation(new OverrideViaAnnotationRequest(entities[i],mergedProperties,isParentExcluded,dynamicEntityDao,prefix));
    }
  }
  ((DefaultMetadataProvider)defaultMetadataProvider).overrideExclusionsFromXml(new OverrideViaXmlRequest(configurationKey,ceilingEntityFullyQualifiedClassname,prefix,isParentExcluded,mergedProperties,dynamicEntityDao));
  boolean handled=false;
  for (  MetadataProvider metadataProvider : metadataProviders) {
    boolean response=metadataProvider.overrideViaXml(new OverrideViaXmlRequest(configurationKey,ceilingEntityFullyQualifiedClassname,prefix,isParentExcluded,mergedProperties,dynamicEntityDao));
    if (response) {
      handled=true;
    }
  }
  if (!handled) {
    defaultMetadataProvider.overrideViaXml(new OverrideViaXmlRequest(configurationKey,ceilingEntityFullyQualifiedClassname,prefix,isParentExcluded,mergedProperties,dynamicEntityDao));
  }
  return mergedProperties;
}
