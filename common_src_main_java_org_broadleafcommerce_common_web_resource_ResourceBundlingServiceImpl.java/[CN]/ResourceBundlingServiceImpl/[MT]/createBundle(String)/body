{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  byte[] bytes=null;
  try {
    for (    Resource r : bundles.get(versionedBundleName)) {
      InputStream is=null;
      try {
        is=r.getInputStream();
        StreamUtils.copy(r.getInputStream(),baos);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
 finally {
        try {
          is.close();
        }
 catch (        IOException e2) {
          throw new RuntimeException(e2);
        }
      }
      if (versionedBundleName.endsWith(".js")) {
        baos.write(";\r\n".getBytes());
      }
 else {
        baos.write("\r\n".getBytes());
      }
    }
    bytes=baos.toByteArray();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      baos.close();
    }
 catch (    IOException e2) {
      throw new RuntimeException(e2);
    }
  }
  byte[] minifiedBytes=minifyService.minify(versionedBundleName,bytes);
  GeneratedResource r=new GeneratedResource(minifiedBytes,versionedBundleName);
  return r;
}
