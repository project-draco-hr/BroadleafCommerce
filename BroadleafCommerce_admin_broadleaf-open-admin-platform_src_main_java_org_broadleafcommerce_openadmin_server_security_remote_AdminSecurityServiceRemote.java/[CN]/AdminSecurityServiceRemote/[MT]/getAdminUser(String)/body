{
  try {
    exploitProtectionService.compareSessionToken(sessionToken);
  }
 catch (  XSRFException e) {
    throw new RuntimeException(e);
  }
  AdminUser persistentAdminUser=getPersistentAdminUser();
  if (persistentAdminUser != null) {
    org.broadleafcommerce.openadmin.client.security.AdminUser response=new org.broadleafcommerce.openadmin.client.security.AdminUser();
    for (    AdminRole role : persistentAdminUser.getAllRoles()) {
      response.getRoles().add(role.getName());
      for (      AdminPermission permission : role.getAllPermissions()) {
        response.getPermissions().add(permission.getName());
      }
    }
    response.setUserName(persistentAdminUser.getLogin());
    response.setCurrentSandBoxId(String.valueOf(SandBoxContext.getSandBoxContext().getSandBoxId()));
    return response;
  }
  return null;
}
