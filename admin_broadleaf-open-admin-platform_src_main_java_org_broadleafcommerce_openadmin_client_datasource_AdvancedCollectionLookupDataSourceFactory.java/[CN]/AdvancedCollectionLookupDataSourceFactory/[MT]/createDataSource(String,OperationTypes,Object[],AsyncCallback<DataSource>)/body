{
  final PersistencePerspective persistencePerspective=new PersistencePerspective();
  final List<DataSourceModule> dataSourceModuleList=new ArrayList<DataSourceModule>();
  collectionMetadata.accept(new MetadataVisitorAdapter(){
    @Override public void visit(    AdornedTargetCollectionMetadata metadata){
      dataSourceModuleList.add(new BasicClientEntityModule(metadata.getCollectionCeilingEntity(),persistencePerspective,AppServices.DYNAMIC_ENTITY));
    }
    @Override public void visit(    BasicCollectionMetadata metadata){
      dataSourceModuleList.add(new BasicClientEntityModule(metadata.getCollectionCeilingEntity(),persistencePerspective,AppServices.DYNAMIC_ENTITY));
    }
    @Override public void visit(    MapMetadata metadata){
      dataSourceModuleList.add(new BasicClientEntityModule(metadata.getMapKeyOptionEntityClass(),persistencePerspective,AppServices.DYNAMIC_ENTITY));
    }
  }
);
  DataSourceModule[] modules=new DataSourceModule[dataSourceModuleList.size()];
  modules=dataSourceModuleList.toArray(modules);
  ListGridDataSource dataSource=new ListGridDataSource(name,persistencePerspective,AppServices.DYNAMIC_ENTITY,modules);
  dataSource.buildFields(null,false,cb);
}
