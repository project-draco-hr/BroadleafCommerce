{
  CriteriaTransferObjectConverter ctoConverter;
  if (cto.get("parentId").getFilterValues()[0] == null) {
    ctoConverter=ctoNullConverter;
  }
 else {
    ctoConverter=ctoRegularConverter;
  }
  PersistentEntityCriteria queryCriteria=ctoConverter.convert(cto,CategoryCtoConverter.GROUP_NAME);
  List<Category> cList=(List<Category>)categoryDao.query(queryCriteria);
  PersistentEntityCriteria countCriteria=ctoConverter.convert(new CriteriaTransferObjectCountWrapper(cto).wrap(),CategoryCtoConverter.GROUP_NAME);
  int totalRecords=categoryDao.count(countCriteria);
  return new ResultSet<Category>(cList,totalRecords);
}
