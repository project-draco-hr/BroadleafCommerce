{
  Authentication auth=SecurityContextHolder.getContext().getAuthentication();
  for (  GrantedAuthority ga : auth.getAuthorities()) {
    if ("ROLE_PASSWORD_CHANGE_REQUIRED".equals(ga.getAuthority())) {
      return passwordChangeUri;
    }
  }
  String successUrlParam=request.getParameter("successUrl");
  if (StringUtils.isNotEmpty(successUrlParam)) {
    return successUrlParam;
  }
  return super.determineTargetUrl(request);
}
