{
  AdminPresentationMapFields annot=addMetadataRequest.getRequestedField().getAnnotation(AdminPresentationMapFields.class);
  for (  AdminPresentationMapField mapField : annot.mapDisplayFields()) {
    if (mapField.fieldPresentation().fieldType() == SupportedFieldType.UNKNOWN) {
      throw new IllegalArgumentException("fieldType property on AdminPresentation must be set for AdminPresentationMapField");
    }
    FieldMetadataOverride override=constructBasicMetadataOverride(mapField.fieldPresentation(),null,null);
    override.setFriendlyName(mapField.fieldName().friendlyKeyName());
    FieldInfo myInfo=new FieldInfo();
    myInfo.setName(addMetadataRequest.getRequestedField().getName() + FieldManager.MAPFIELDSEPARATOR + mapField.fieldName().keyName());
    if (!mapField.targetClass().equals(Void.class)) {
      if (mapField.targetClass().isInterface()) {
        throw new IllegalArgumentException("targetClass on @AdminPresentationMapField must be a concrete class");
      }
      override.setValueClass(mapField.targetClass().getName());
    }
    buildBasicMetadata(addMetadataRequest.getParentClass(),addMetadataRequest.getTargetClass(),addMetadataRequest.getRequestedMetadata(),myInfo,override,addMetadataRequest.getDynamicEntityDao());
    setClassOwnership(addMetadataRequest.getParentClass(),addMetadataRequest.getTargetClass(),addMetadataRequest.getRequestedMetadata(),myInfo);
  }
}
