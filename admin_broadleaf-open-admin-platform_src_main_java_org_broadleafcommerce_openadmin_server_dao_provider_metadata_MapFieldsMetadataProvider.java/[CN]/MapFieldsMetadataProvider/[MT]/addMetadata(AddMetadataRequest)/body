{
  AdminPresentationMapFields annot=addMetadataRequest.getRequestedField().getAnnotation(AdminPresentationMapFields.class);
  for (  AdminPresentationMapField mapField : annot.mapDisplayFields()) {
    if (mapField.fieldPresentation().fieldType() == SupportedFieldType.UNKNOWN) {
      throw new IllegalArgumentException("fieldType property on AdminPresentation must be set for AdminPresentationMapField");
    }
    FieldMetadataOverride override=constructBasicMetadataOverride(mapField.fieldPresentation(),null,null);
    override.setFriendlyName(mapField.fieldPresentation().friendlyName());
    FieldInfo myInfo=new FieldInfo();
    myInfo.setName(addMetadataRequest.getRequestedField().getName() + FieldManager.MAPFIELDSEPARATOR + mapField.fieldName());
    buildBasicMetadata(addMetadataRequest.getParentClass(),addMetadataRequest.getTargetClass(),addMetadataRequest.getRequestedMetadata(),myInfo,override,addMetadataRequest.getDynamicEntityDao());
    setClassOwnership(addMetadataRequest.getParentClass(),addMetadataRequest.getTargetClass(),addMetadataRequest.getRequestedMetadata(),myInfo);
    BasicFieldMetadata metadata=(BasicFieldMetadata)addMetadataRequest.getRequestedMetadata().get(addMetadataRequest.getRequestedField().getName());
    if (!mapField.targetClass().equals(Void.class)) {
      if (mapField.targetClass().isInterface()) {
        throw new IllegalArgumentException("targetClass on @AdminPresentationMapField must be a concrete class");
      }
      metadata.setMapFieldValueClass(mapField.targetClass().getName());
    }
    if (mapField.searchable() != CustomFieldSearchableTypes.NOT_SPECIFIED) {
      metadata.setSearchable(mapField.searchable() == CustomFieldSearchableTypes.YES);
    }
    if (!StringUtils.isEmpty(mapField.manyToField())) {
      metadata.setManyToField(mapField.manyToField());
    }
  }
}
