{
  Customer customer=customerId != null ? readCustomerById(customerId) : null;
  if (customer == null) {
    customer=(Customer)entityConfiguration.createEntityInstance("org.broadleafcommerce.profile.domain.Customer");
    customer.setId(idGenerationService.findNextId("org.broadleafcommerce.profile.domain.Customer"));
  }
  return customer;
}
