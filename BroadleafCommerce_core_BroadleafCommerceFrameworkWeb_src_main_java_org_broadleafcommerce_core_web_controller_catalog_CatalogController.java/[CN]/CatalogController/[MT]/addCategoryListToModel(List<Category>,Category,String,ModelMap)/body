{
  boolean categoryError=false;
  while (categoryList == null) {
    categoryError=true;
    int pos=url.indexOf("/");
    if (pos == -1) {
      categoryList=new ArrayList<Category>();
      categoryList.add(rootCategory);
    }
 else {
      url=url.substring(0,url.lastIndexOf("/"));
      categoryList=catalogService.getChildCategoryURLMapByCategoryId(rootCategory.getId()).get(url);
    }
  }
  List<Category> siblingCategories=new ArrayList<Category>();
  Category currentCategory=(Category)categoryList.get(categoryList.size() - 1);
  siblingCategories=currentCategory.getAllChildCategories();
  model.addAttribute("breadcrumbCategories",categoryList);
  model.addAttribute("currentCategory",categoryList.get(categoryList.size() - 1));
  model.addAttribute("categoryError",categoryError);
  model.addAttribute("displayCategories",siblingCategories);
  return categoryError;
}
