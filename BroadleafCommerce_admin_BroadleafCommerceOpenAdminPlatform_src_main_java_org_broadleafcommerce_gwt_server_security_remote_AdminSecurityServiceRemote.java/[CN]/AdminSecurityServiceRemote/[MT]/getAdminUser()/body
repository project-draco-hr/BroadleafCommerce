{
  SecurityContext ctx=SecurityContextHolder.getContext();
  if (ctx != null) {
    Authentication auth=ctx.getAuthentication();
    if (auth != null && !auth.getName().equals(ANONYMOUS_USER_NAME)) {
      User temp=(User)auth.getPrincipal();
      AdminUser adminUser=securityService.readAdminUserByUserName(temp.getUsername());
      org.broadleafcommerce.gwt.client.security.AdminUser response=new org.broadleafcommerce.gwt.client.security.AdminUser();
      for (      AdminRole role : adminUser.getAllRoles()) {
        response.getRoles().add(role.getName());
        for (        AdminPermission permission : role.getAllPermissions()) {
          response.getPermissions().add(permission.getName());
        }
      }
      return response;
    }
  }
  return null;
}
