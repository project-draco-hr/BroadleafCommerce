{
  for (  File srcFile : files) {
    if (!srcFile.getAbsolutePath().startsWith(area.getFilePathLocation())) {
      throw new FileServiceException("Attempt to update file " + srcFile.getAbsolutePath() + " that is not in the passed in WorkArea "+ area.getFilePathLocation());
    }
    String fileName=srcFile.getAbsolutePath().substring(area.getFilePathLocation().length());
    String resourceName=buildResourceName(fileName);
    File destFile=new File(getBaseDirectory() + resourceName);
    if (!destFile.getParentFile().exists()) {
      destFile.getParentFile().mkdirs();
    }
    try {
      if (removeResourcesFromWorkArea) {
        FileUtils.moveFile(srcFile,destFile);
      }
 else {
        FileUtils.copyFile(srcFile,destFile);
      }
    }
 catch (    IOException ioe) {
      throw new FileServiceException("Error copying resource named " + fileName + " from workArea "+ area.getFilePathLocation()+ " to "+ resourceName,ioe);
    }
  }
}
