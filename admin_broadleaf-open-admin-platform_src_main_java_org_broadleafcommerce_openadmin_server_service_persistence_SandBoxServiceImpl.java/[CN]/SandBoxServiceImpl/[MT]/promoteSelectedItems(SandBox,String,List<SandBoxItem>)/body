{
  SandBox destinationSandBox=determineNextSandBox(fromSandBox);
  SandBoxAction action=createSandBoxAction(SandBoxActionType.PROMOTE,comment);
  for (  SandBoxItem sandBoxItem : sandBoxItems) {
    action.addSandBoxItem(sandBoxItem);
    if (destinationSandBox == null || SandBoxType.PRODUCTION.equals(destinationSandBox)) {
      sandBoxItem.setArchivedFlag(true);
    }
    if (destinationSandBox != null) {
      sandBoxItem.setSandBoxId(destinationSandBox.getId());
    }
 else {
      sandBoxItem.setSandBoxId(null);
    }
    if (sandBoxItem.getOriginalSandBoxId() == null) {
      sandBoxItem.setOriginalSandBoxId(fromSandBox.getId());
    }
    sandBoxItem.addSandBoxAction(action);
    for (    SandBoxItemListener listener : sandboxItemListeners) {
      listener.itemPromoted(sandBoxItem,destinationSandBox);
    }
  }
}
