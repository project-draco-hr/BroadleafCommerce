{
  RateV2RequestDocument doc=RateV2RequestDocument.Factory.newInstance();
  RateV2RequestType v2Request=doc.addNewRateV2Request();
  v2Request.setUSERID(username);
  v2Request.setPASSWORD(password);
  for (  USPSContainerItemRequest itemRequest : request.getContainerItems()) {
    RequestPackageV2Type requestPackage=v2Request.addNewPackage();
    if (itemRequest.getContainerShape() != null) {
      String containerShape=itemRequest.getContainerShape().getType();
      String[] tokens=containerShape.split(" ");
      StringBuffer sb=new StringBuffer();
      for (      String token : tokens) {
        if (sb.length() > 0) {
          sb.append(" ");
        }
        sb.append(token.substring(0,1));
        sb.append(token.substring(1,token.length()).toLowerCase());
      }
      requestPackage.setContainer(RequestPackageV2Type.Container.Enum.forString(sb.toString()));
    }
    if (itemRequest.getPackageId() != null) {
      requestPackage.setID(itemRequest.getPackageId());
    }
    if (itemRequest.isMachineSortable() != null) {
      requestPackage.setMachinable(itemRequest.isMachineSortable());
    }
    if (itemRequest.getWeight() != null) {
      DecimalFormat format=new DecimalFormat("0.#");
      requestPackage.setOunces(format.format(UnitOfMeasureUtil.findRemainingOunces(itemRequest.getWeight(),itemRequest.getWeightUnitOfMeasureType()).doubleValue()));
      requestPackage.setPounds(UnitOfMeasureUtil.findWholePounds(itemRequest.getWeight(),itemRequest.getWeightUnitOfMeasureType()));
    }
    if (itemRequest.getService() != null) {
      requestPackage.setService(RequestPackageV2Type.Service.Enum.forString(itemRequest.getService().getType()));
    }
    if (itemRequest.getContainerSize() != null) {
      requestPackage.setSize(RequestPackageV2Type.Size.Enum.forString(itemRequest.getContainerSize().getType()));
    }
    if (itemRequest.getZipDestination() != null) {
      requestPackage.setZipDestination(Integer.valueOf(itemRequest.getZipDestination()));
    }
    if (itemRequest.getZipOrigination() != null) {
      requestPackage.setZipOrigination(Integer.valueOf(itemRequest.getZipOrigination()));
    }
  }
  return doc;
}
