{
  String key=String.valueOf(batchPersistencePackage.hashCode());
  if (METADATA_CACHE.containsKey(key)) {
    for (    PersistencePackage persistencePackage : batchPersistencePackage.getPersistencePackages()) {
      exploitProtectionService.compareToken(persistencePackage.getCsrfToken());
    }
    return METADATA_CACHE.get(key);
  }
  DynamicResultSet[] results=new DynamicResultSet[batchPersistencePackage.getPersistencePackages().length];
  for (int j=0; j < batchPersistencePackage.getPersistencePackages().length; j++) {
    results[j]=inspect(batchPersistencePackage.getPersistencePackages()[j]);
  }
  BatchDynamicResultSet batchResults=new BatchDynamicResultSet();
  batchResults.setDynamicResultSets(results);
  METADATA_CACHE.put(key,batchResults);
  return METADATA_CACHE.get(key);
}
