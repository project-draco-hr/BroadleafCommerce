{
  RequestMessage request=super.buildRequestMessage(paymentRequest);
  if (CyberSourceTransactionType.AUTHORIZE.equals(paymentRequest.getTransactionType()) || CyberSourceTransactionType.AUTHORIZEANDCAPTURE.equals(paymentRequest.getTransactionType())) {
    setCardInformation(paymentRequest,request);
    setBillingInformation(paymentRequest,request);
    setItemInformation(paymentRequest,request);
    request.setCcAuthService(new CCAuthService());
    request.getCcAuthService().setRun("true");
  }
  if (CyberSourceTransactionType.AUTHORIZEANDCAPTURE.equals(paymentRequest.getTransactionType())) {
    request.setCcCaptureService(new CCCaptureService());
    request.getCcCaptureService().setRun("true");
  }
  if (CyberSourceTransactionType.CAPTURE.equals(paymentRequest.getTransactionType())) {
    CyberSourceCardRequest captureRequest=(CyberSourceCardRequest)paymentRequest;
    setItemInformation(paymentRequest,request);
    request.setCcCaptureService(new CCCaptureService());
    request.getCcCaptureService().setRun("true");
    request.getCcCaptureService().setAuthRequestID(captureRequest.getRequestID());
    request.getCcCaptureService().setAuthRequestToken(captureRequest.getRequestToken());
  }
  return request;
}
