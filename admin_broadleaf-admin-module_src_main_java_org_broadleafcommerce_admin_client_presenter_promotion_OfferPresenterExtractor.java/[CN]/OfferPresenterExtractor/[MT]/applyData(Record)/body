{
  try {
    final Map<String,Object> dirtyValues=new HashMap<String,Object>();
    setData(selectedRecord,"totalitarianOffer",getDisplay().getRestrictRuleRadio().getValue().equals("YES"),dirtyValues);
    setData(selectedRecord,"deliveryType",getDisplay().getDeliveryTypeRadio().getValue(),dirtyValues);
    if (getDisplay().getDeliveryTypeRadio().getValue().equals("CODE")) {
      setData(selectedRecord,"offerCode.offerCode",getDisplay().getCodeField().getValue().toString().trim(),dirtyValues);
    }
    final String type=getDisplay().getDynamicFormDisplay().getFormOnlyDisplay().getForm().getField("type").getValue().toString();
    extractCustomerData(selectedRecord,dirtyValues);
    extractOrderData(selectedRecord,type,dirtyValues);
    extractQualifierRuleType(selectedRecord,dirtyValues);
    extractTargetItemData(selectedRecord,type,dirtyValues);
    extractTargetRuleType(selectedRecord,dirtyValues);
    extractFulfillmentGroupData(selectedRecord,type,dirtyValues);
    for (    FormItem formItem : getDisplay().getDynamicFormDisplay().getFormOnlyDisplay().getForm().getFields()) {
      setData(selectedRecord,formItem.getName(),formItem.getValue(),dirtyValues);
    }
    extractQualifierData(selectedRecord,type,true,dirtyValues);
    DSRequest requestProperties=new DSRequest();
    requestProperties.setAttribute("dirtyValues",dirtyValues);
    getDisplay().getDynamicFormDisplay().getFormOnlyDisplay().getForm().getDataSource().updateData(selectedRecord,new DSCallback(){
      public void execute(      DSResponse response,      Object rawData,      DSRequest request){
        try {
          extractQualifierData(selectedRecord,type,false,dirtyValues);
          getDisplay().getDynamicFormDisplay().getSaveButton().disable();
          getDisplay().getDynamicFormDisplay().getRefreshButton().disable();
        }
 catch (        IncompatibleMVELTranslationException e) {
          SC.warn(e.getMessage());
        }
      }
    }
,requestProperties);
  }
 catch (  IncompatibleMVELTranslationException e) {
    SC.warn(e.getMessage());
  }
}
