{
  InputStream classPathInputStream=getResourceFromClasspath(staticAsset);
  if (classPathInputStream != null) {
    return classPathInputStream;
  }
  if (StorageType.DATABASE.equals(staticAsset.getStorageType())) {
    StaticAssetStorage storage=readStaticAssetStorageByStaticAssetId(staticAsset.getId());
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    InputStream is=null;
    try {
      is=storage.getFileData().getBinaryStream();
      byte[] buffer=new byte[fileBufferSize];
      int bytesRead;
      while ((bytesRead=is.read(buffer)) != -1) {
        baos.write(buffer,0,bytesRead);
      }
      baos.flush();
    }
  finally {
      if (is != null) {
        try {
          is.close();
        }
 catch (        Throwable e) {
        }
      }
    }
    InputStream original=new ByteArrayInputStream(baos.toByteArray());
    return original;
  }
 else   if (StorageType.FILESYSTEM.equals(staticAsset.getStorageType())) {
    FileInputStream assetFile=new FileInputStream(generateStorageFileName(staticAsset.getFullUrl(),false));
    BufferedInputStream bufferedStream=new BufferedInputStream(assetFile);
    bufferedStream.mark(0);
    return bufferedStream;
  }
 else {
    throw new IllegalArgumentException("Unknown storage type while trying to read static asset.");
  }
}
