{
  try {
    PaymentSeed seed=new PaymentSeed(order,payments,response);
    paymentWorkflow.doActivities(seed);
    return seed;
  }
 catch (  WorkflowException e) {
    Throwable cause=null;
    while (e.getCause() != null) {
      if (cause != null && cause.equals(e.getCause())) {
        break;
      }
      cause=e.getCause();
    }
    if (cause != null && PaymentException.class.isAssignableFrom(cause.getClass())) {
      throw (PaymentException)cause;
    }
    throw new PaymentException("Unable to execute payment for order -- id: " + order.getId(),e);
  }
}
