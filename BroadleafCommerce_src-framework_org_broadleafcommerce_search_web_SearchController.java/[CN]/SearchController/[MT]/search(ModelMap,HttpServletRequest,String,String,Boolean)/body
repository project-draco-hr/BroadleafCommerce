{
  SearchQuery input=new SearchQuery();
  input.setQueryString(queryString);
  List<Product> products=null;
  products=searchService.performSearch(input.getQueryString());
  SearchFilterUtil.filterProducts(products,request.getParameterMap(),new String[]{"manufacturer","defaultCategory.id","sku[0].salePrice"});
  model.addAttribute("queryString",input.getQueryString());
  model.addAttribute("products",products);
  if (ajax == null || !ajax.booleanValue() || (originalQueryString != null && !originalQueryString.equals(queryString))) {
    return "search";
  }
 else {
    return "searchAjax";
  }
}
