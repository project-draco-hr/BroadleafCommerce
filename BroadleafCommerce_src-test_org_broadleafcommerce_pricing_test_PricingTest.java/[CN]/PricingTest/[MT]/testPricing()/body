{
  Order order=orderDao.create();
  order.setCustomer(createCustomer());
  FulfillmentGroup group=new FulfillmentGroupImpl();
  List<FulfillmentGroup> groups=new ArrayList<FulfillmentGroup>();
  group.setMethod("standard");
  groups.add(group);
  order.setFulfillmentGroups(groups);
  Money total=new Money(5D);
  group.setShippingPrice(total);
  DiscreteOrderItemImpl item=new DiscreteOrderItemImpl();
  Sku sku=new SkuImpl();
  sku.setId(123456L);
  sku.setRetailPrice(new Money(10D));
  sku.setDiscountable(true);
  item.setSku(sku);
  item.setQuantity(2);
  order.addOrderItem(item);
  item=new DiscreteOrderItemImpl();
  sku=new SkuImpl();
  sku.setId(1234567L);
  sku.setRetailPrice(new Money(20D));
  sku.setDiscountable(true);
  item.setSku(sku);
  item.setQuantity(1);
  order.addOrderItem(item);
  order.addAddedOfferCode(createOfferCode("20 Percent Off Item Offer",OfferType.ORDER_ITEM,OfferDiscountType.PERCENT_OFF,20,null,"discreteOrderItem.sku.id == 123456"));
  order.addAddedOfferCode(createOfferCode("3 Dollars Off Item Offer",OfferType.ORDER_ITEM,OfferDiscountType.AMOUNT_OFF,3,null,"discreteOrderItem.sku.id != 123456"));
  order.addAddedOfferCode(createOfferCode("1.20 Dollars Off Order Offer",OfferType.ORDER,OfferDiscountType.AMOUNT_OFF,1.20,null,null));
  order.setTotalShipping(new Money(0D));
  order=pricingService.executePricing(order);
  assert(order.getTotal().greaterThan(order.getSubTotal()));
  assert(order.getTotalTax().equals(order.getSubTotal().multiply(0.05D)));
  assert(order.getTotal().equals(order.getSubTotal().add(order.getTotalTax()).add(order.getTotalShipping())));
}
