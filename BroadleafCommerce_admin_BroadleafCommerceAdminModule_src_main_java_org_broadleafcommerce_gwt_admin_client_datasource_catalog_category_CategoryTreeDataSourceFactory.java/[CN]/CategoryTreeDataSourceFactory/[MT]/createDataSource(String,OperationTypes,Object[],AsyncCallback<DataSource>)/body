{
  if (dataSource == null) {
    operationTypes=new OperationTypes(OperationType.JOINSTRUCTURE,OperationType.FOREIGNKEY,OperationType.ENTITY,OperationType.ENTITY,OperationType.ENTITY);
    PersistencePerspective persistencePerspective=new PersistencePerspective(operationTypes,new String[]{hasChildrenProperty},new ForeignKey[]{new ForeignKey(defaultParentCategoryForeignKey,EntityImplementations.CATEGORY,null)});
    persistencePerspective.addPersistencePerspectiveItem(PersistencePerspectiveItemType.FOREIGNKEY,new ForeignKey(foreignKeyName,EntityImplementations.CATEGORY,null));
    persistencePerspective.addPersistencePerspectiveItem(PersistencePerspectiveItemType.JOINSTRUCTURE,new JoinStructure(foreignKeyName,"categoryXrefPK.category","id","categoryXrefPK.subCategory","id",EntityImplementations.CATEGORY_XREF,"displayOrder",true));
    DataSourceModule[] modules=new DataSourceModule[]{new CategoryTreeEntityModule(CeilingEntities.CATEGORY,persistencePerspective,AppServices.DYNAMIC_ENTITY),new CategoryTreeJoinStructureModule(CeilingEntities.CATEGORY,persistencePerspective,AppServices.DYNAMIC_ENTITY)};
    dataSource=new CategoryTreeDataSource(name,persistencePerspective,AppServices.DYNAMIC_ENTITY,modules,(String)additionalItems[0],(String)additionalItems[1]);
    dataSource.buildFields(null,false,cb);
  }
 else {
    if (cb != null) {
      cb.onSuccess(dataSource);
    }
  }
}
