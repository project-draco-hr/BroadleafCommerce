{
  logger.info("Rebuilding product index");
  List<Product> products=catalogService.findAllProducts();
  SearchEngineIndexManager manager=compass.getSearchEngineIndexManager();
  if (!manager.indexExists()) {
    manager.createIndex();
  }
  CompassIndexSession session=compass.openIndexSession();
  for (  Product product : products) {
    session.save(product);
  }
  session.commit();
  session.close();
}
