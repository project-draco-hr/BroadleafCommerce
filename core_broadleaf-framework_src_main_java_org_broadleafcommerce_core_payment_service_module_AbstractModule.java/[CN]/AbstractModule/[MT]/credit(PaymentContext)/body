{
  Money amountAvailableToCredit=getAmountAvailableToCredit(paymentContext);
  PaymentInfo paymentInfo=findPaymentInfoFromContext(paymentContext);
  PaymentResponseItem responseItem=getNewResponseItem();
  responseItem.setTransactionTimestamp(SystemTime.asDate());
  responseItem.setAmountPaid(amountAvailableToCredit);
  responseItem.setCurrency(paymentInfo.getCurrency());
  paymentInfo.getPaymentInfoDetails().add(getNewRefundPaymentInfoDetail(paymentInfo,amountAvailableToCredit));
  return processCredit(paymentContext,amountAvailableToCredit,responseItem);
}
