{
  if (sandboxPageList == null || sandboxPageList.size() == 0) {
    return productionPageList;
  }
  Map<Long,PageDTO> pageMap=new LinkedHashMap<Long,PageDTO>();
  if (productionPageList != null) {
    for (    PageDTO page : productionPageList) {
      pageMap.put(page.getId(),page);
    }
  }
  for (  Page page : sandboxPageList) {
    if (page.getOriginalPageId() != null) {
      pageMap.remove(page.getOriginalPageId());
    }
    if (!page.getDeletedFlag() && page.getOfflineFlag() != null && !page.getOfflineFlag()) {
      PageDTO convertedPage=buildPageDTOInternal(page,secure);
      pageMap.put(page.getId(),convertedPage);
    }
  }
  ArrayList<PageDTO> returnList=new ArrayList<PageDTO>(pageMap.values());
  if (returnList.size() > 1) {
    Collections.sort(returnList,new BeanComparator("priority"));
  }
  return returnList;
}
