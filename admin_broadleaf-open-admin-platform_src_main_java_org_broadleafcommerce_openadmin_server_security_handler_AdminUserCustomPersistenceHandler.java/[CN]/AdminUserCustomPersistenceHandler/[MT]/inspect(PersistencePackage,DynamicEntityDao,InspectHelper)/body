{
  try {
    Class<?>[] entities=dynamicEntityDao.getAllPolymorphicEntitiesFromCeiling(Class.forName(persistencePackage.getCeilingEntityFullyQualifiedClassname()));
    Map<MergedPropertyType,Map<String,FieldMetadata>> allMergedProperties=new HashMap<MergedPropertyType,Map<String,FieldMetadata>>();
    PersistenceModule persistenceModule=helper.getCompatibleModule(persistencePackage.getPersistencePerspective().getOperationTypes().getInspectType());
    persistenceModule.updateMergedProperties(persistencePackage,allMergedProperties);
    ClassMetadata mergedMetadata=helper.getMergedClassMetadata(entities,allMergedProperties);
    DynamicResultSet results=new DynamicResultSet(mergedMetadata);
    return results;
  }
 catch (  ClassNotFoundException e) {
    LOG.error("Unable to inspect",e);
    throw new ServiceException("Unable to inspect",e);
  }
}
