{
  Source xmlSource;
  int maxCount=(rowCount > -1 && contentDetails.size() > 0) ? rowCount : contentDetails.size();
  Writer resultWriter=new StringWriter();
  StreamResult result=new StreamResult(resultWriter);
  Source styleSheetSource=getSource(styleSheetString);
  TransformerFactory transformerFactory=TransformerFactory.newInstance();
  Transformer transformer=transformerFactory.newTransformer(styleSheetSource);
  for (int i=0; i < maxCount; i++) {
    ContentDetails contentDetail=contentDetails.get(i);
    xmlSource=getSource(contentDetail.getXmlContent());
    try {
      transformer.transform(xmlSource,result);
    }
 catch (    Exception e) {
      LOG.error("Error during transformation. ",e);
      throw e;
    }
  }
  return StringEscapeUtils.unescapeXml(resultWriter.toString());
}
