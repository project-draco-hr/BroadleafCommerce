{
  Site site=siteResolver.resolveSite(request);
  BroadleafRequestContext brc=new BroadleafRequestContext();
  BroadleafRequestContext.setBroadleafRequestContext(brc);
  brc.setSite(site);
  brc.setWebRequest(request);
  brc.setIgnoreSite(site == null);
  Locale locale=localeResolver.resolveLocale(request);
  brc.setLocale(locale);
  brc.setMessageSource(messageSource);
  TimeZone timeZone=broadleafTimeZoneResolver.resolveTimeZone(request);
  brc.setTimeZone(timeZone);
  BroadleafCurrency currency=currencyResolver.resolveCurrency(request);
  brc.setBroadleafCurrency(currency);
}
