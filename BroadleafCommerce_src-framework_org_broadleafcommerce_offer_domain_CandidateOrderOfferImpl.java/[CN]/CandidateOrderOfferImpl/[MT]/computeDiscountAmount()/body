{
  if (offer != null && order != null) {
    Money priceToUse=order.getSubTotal();
    if (offer.getDiscountType() == OfferDiscountType.AMOUNT_OFF) {
      priceToUse.subtract(offer.getValue());
    }
    if (offer.getDiscountType() == OfferDiscountType.FIX_PRICE) {
      priceToUse=offer.getValue();
    }
    if (offer.getDiscountType() == OfferDiscountType.PERCENT_OFF) {
      priceToUse=priceToUse.multiply(offer.getValue().divide(new BigDecimal("100")).getAmount());
    }
    discountedPrice=priceToUse;
  }
}
