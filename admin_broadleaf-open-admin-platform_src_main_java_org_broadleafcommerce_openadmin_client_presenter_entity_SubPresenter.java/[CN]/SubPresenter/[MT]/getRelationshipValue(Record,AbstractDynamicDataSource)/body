{
  if (prefix.equals("")) {
    return abstractDynamicDataSource.getPrimaryKeyValue(associatedRecord);
  }
 else {
    String[] prefixParts=prefix.split("\\.");
    for (int j=0; j < prefixParts.length; j++) {
      StringBuilder sb=new StringBuilder();
      for (int x=0; x < prefixParts.length - j; x++) {
        sb.append(prefixParts[x]);
        if (x < prefixParts.length - j - 1) {
          sb.append(".");
        }
      }
      String tempPrefix=sb.toString();
      for (      String fieldName : abstractDynamicDataSource.getFieldNames()) {
        if (fieldName.startsWith(tempPrefix)) {
          DataSourceField field=abstractDynamicDataSource.getField(fieldName);
          if (SupportedFieldType.ID == SupportedFieldType.valueOf(field.getAttribute("fieldType"))) {
            return abstractDynamicDataSource.stripDuplicateAllowSpecialCharacters(associatedRecord.getAttribute(fieldName));
          }
        }
      }
    }
  }
  throw new RuntimeException("Unable to establish a relationship value for the datasource: " + abstractDynamicDataSource.getDataURL());
}
