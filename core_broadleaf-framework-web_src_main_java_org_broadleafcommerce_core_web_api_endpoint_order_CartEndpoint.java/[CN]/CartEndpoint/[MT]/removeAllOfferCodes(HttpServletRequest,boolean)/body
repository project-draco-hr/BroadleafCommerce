{
  Order cart=CartState.getCart();
  if (cart == null || cart instanceof NullOrderImpl) {
    throw new WebApplicationException(Response.status(Response.Status.NOT_FOUND).type(MediaType.TEXT_PLAIN).entity("Cart could not be found").build());
  }
  try {
    cart=orderService.removeAllOfferCodes(cart,priceOrder);
    OrderWrapper wrapper=(OrderWrapper)context.getBean(OrderWrapper.class.getName());
    wrapper.wrapDetails(cart,request);
    return wrapper;
  }
 catch (  PricingException e) {
    throw new WebApplicationException(e,Response.status(Response.Status.INTERNAL_SERVER_ERROR).type(MediaType.TEXT_PLAIN).entity("An error occured pricing the cart.").build());
  }
}
