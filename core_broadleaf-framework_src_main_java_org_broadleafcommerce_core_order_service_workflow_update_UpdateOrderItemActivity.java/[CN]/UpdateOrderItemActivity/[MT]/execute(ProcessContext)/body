{
  CartOperationRequest request=((CartOperationContext)context).getSeedData();
  OrderItemRequestDTO orderItemRequestDTO=request.getItemRequest();
  Order order=request.getOrder();
  OrderItem orderItem=null;
  for (  DiscreteOrderItem doi : order.getDiscreteOrderItems()) {
    if (doi.getId().equals(orderItemRequestDTO.getOrderItemId())) {
      orderItem=doi;
    }
  }
  if (orderItem == null || !order.getOrderItems().contains(orderItem)) {
    throw new ItemNotFoundException("Order Item (" + orderItem.getId() + ") not found in Order ("+ order.getId()+ ")");
  }
  OrderItem itemFromOrder=order.getOrderItems().get(order.getOrderItems().indexOf(orderItem));
  request.setOrderItemQuantityDelta(orderItemRequestDTO.getQuantity() - itemFromOrder.getQuantity());
  itemFromOrder.setQuantity(orderItemRequestDTO.getQuantity());
  order=orderService.save(order,false);
  request.setAddedOrderItem(itemFromOrder);
  request.setOrder(order);
  return context;
}
