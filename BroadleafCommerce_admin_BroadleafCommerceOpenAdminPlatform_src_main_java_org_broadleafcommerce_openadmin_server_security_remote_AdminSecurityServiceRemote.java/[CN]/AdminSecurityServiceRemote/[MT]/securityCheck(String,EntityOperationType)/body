{
  if (ceilingEntityFullyQualifiedName == null) {
    throw new ServiceException("Security Check Failed: ceilingEntityFullyQualifiedName not specified");
  }
  AdminUser persistentAdminUser=getPersistentAdminUser();
  PermissionType permissionType;
switch (operationType) {
case ADD:
    permissionType=PermissionType.CREATE;
  break;
case FETCH:
permissionType=PermissionType.READ;
break;
case REMOVE:
permissionType=PermissionType.DELETE;
break;
case UPDATE:
permissionType=PermissionType.UPDATE;
break;
case INSPECT:
permissionType=PermissionType.READ;
break;
default :
permissionType=PermissionType.OTHER;
break;
}
boolean isQualified=securityService.isUserQualifiedForOperationOnCeilingEntity(persistentAdminUser,permissionType,ceilingEntityFullyQualifiedName);
if (!isQualified) {
if (isEntitySecurityExplicit || securityService.doesOperationExistForCeilingEntity(permissionType,ceilingEntityFullyQualifiedName)) {
throw new ServiceException("Security Check Failed for entity operation: " + operationType.toString());
}
}
}
