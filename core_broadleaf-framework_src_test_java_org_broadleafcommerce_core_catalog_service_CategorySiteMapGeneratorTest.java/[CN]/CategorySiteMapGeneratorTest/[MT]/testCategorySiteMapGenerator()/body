{
  Category rootCategory=new CategoryImpl();
  Category c1=new CategoryImpl();
  c1.setUrl("/");
  c1.setDefaultParentCategory(rootCategory);
  Category c2=new CategoryImpl();
  c2.setUrl("/hot-sauces");
  c2.setDefaultParentCategory(rootCategory);
  Category c3=new CategoryImpl();
  c3.setUrl("merchandise");
  c3.setDefaultParentCategory(rootCategory);
  Category c4=new CategoryImpl();
  c4.setUrl("/clearance");
  c4.setDefaultParentCategory(rootCategory);
  List<Category> categories=new ArrayList<Category>();
  categories.add(c1);
  categories.add(c2);
  categories.add(c3);
  categories.add(c4);
  CategoryDao categoryDao=EasyMock.createMock(CategoryDao.class);
  EasyMock.expect(categoryDao.readActiveSubCategoriesByCategory(rootCategory,5,0)).andReturn(categories).atLeastOnce();
  EasyMock.replay(categoryDao);
  CategorySiteMapGenerator csmg=new CategorySiteMapGenerator();
  csmg.setCategoryDao(categoryDao);
  csmg.setRowLimit(5);
  CategorySiteMapGeneratorConfiguration smgc=new CategorySiteMapGeneratorConfigurationImpl();
  smgc.setDisabled(false);
  smgc.setSiteMapGeneratorType(SiteMapGeneratorType.CATEGORY);
  smgc.setSiteMapChangeFreq(SiteMapChangeFreqType.HOURLY);
  smgc.setSiteMapPriority(SiteMapPriorityType.POINT5);
  smgc.setRootCategory(rootCategory);
  smgc.setStartingDepth(1);
  smgc.setEndingDepth(1);
  testGenerator(smgc,csmg);
  File file1=fileService.getResource("/sitemap_index.xml");
  File file2=fileService.getResource("/sitemap1.xml");
  File file3=fileService.getResource("/sitemap2.xml");
  compareFiles(file1,"src/test/resources/org/broadleafcommerce/sitemap/category/sitemap_index.xml");
  compareFiles(file2,"src/test/resources/org/broadleafcommerce/sitemap/category/sitemap1.xml");
  compareFiles(file3,"src/test/resources/org/broadleafcommerce/sitemap/category/sitemap2.xml");
  testGenerator(smgc,csmg,50000);
  File file4=fileService.getResource("/sitemap.xml");
  compareFiles(file4,"src/test/resources/org/broadleafcommerce/sitemap/category/sitemap.xml");
}
