{
  UserDetails principal=userDetailsService.loadUserByUsername(customer.getUsername());
  UsernamePasswordAuthenticationToken token=new UsernamePasswordAuthenticationToken(principal,customer.getUnencodedPassword(),principal.getAuthorities());
  Authentication authentication=authenticationManager.authenticate(token);
  SecurityContextHolder.getContext().setAuthentication(authentication);
  return authentication;
}
