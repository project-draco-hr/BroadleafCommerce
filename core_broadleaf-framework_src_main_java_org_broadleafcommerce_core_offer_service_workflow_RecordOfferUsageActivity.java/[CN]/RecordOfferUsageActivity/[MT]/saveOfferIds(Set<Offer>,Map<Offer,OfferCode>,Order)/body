{
  List<OfferAudit> audits=new ArrayList<OfferAudit>(offers.size());
  for (  Offer offer : offers) {
    OfferAudit audit=offerAuditService.create();
    audit.setCustomerId(order.getCustomer().getId());
    audit.setOfferId(offer.getId());
    audit.setOrderId(order.getId());
    try {
      OfferCode codeUsedToRetrieveOffer=offerToCodeMapping.get(offer);
      if (codeUsedToRetrieveOffer != null) {
        audit.setOfferCodeId(codeUsedToRetrieveOffer.getId());
      }
    }
 catch (    UnsupportedOperationException e) {
      LOG.warn("Checking for offer code max usage has not been enabled in your Broadleaf installation. This warning" + " will only appear in the Broadleaf 3.0 line, versions 3.0.6-GA and above. In order to fix your" + " version of Broadleaf to enable this functionality, refer to the OfferAuditWeaveImpl or directly to"+ " https://github.com/BroadleafCommerce/BroadleafCommerce/pull/195.");
    }
    audit.setRedeemedDate(SystemTime.asDate());
    audit=offerAuditService.save(audit);
    audits.add(audit);
  }
  return audits;
}
