{
  Order bo=null;
  Query query=em.createNamedQuery("BC_READ_ORDERS_BY_CUSTOMER_ID_AND_NAME_NULL");
  query.setParameter("customerId",customer.getId());
  query.setParameter("orderStatus",OrderStatus.IN_PROCESS);
  try {
    bo=(Order)query.getSingleResult();
    return (Order)query.getSingleResult();
  }
 catch (  NoResultException nre) {
    if (persist) {
      bo=(Order)entityConfiguration.createEntityInstance("org.broadleafcommerce.order.domain.Order");
      bo.setCustomer(customer);
      bo.setStatus(OrderStatus.IN_PROCESS);
      em.persist(bo);
    }
    return bo;
  }
}
