{
  if (ceilingEntityFullyQualifiedName == null) {
    throw new SecurityServiceException("Security Check Failed: ceilingEntityFullyQualifiedName not specified");
  }
  AdminUser persistentAdminUser=getPersistentAdminUser();
  PermissionType permissionType;
switch (operationType) {
case ADD:
    permissionType=PermissionType.CREATE;
  break;
case FETCH:
permissionType=PermissionType.READ;
break;
case REMOVE:
permissionType=PermissionType.DELETE;
break;
case UPDATE:
permissionType=PermissionType.UPDATE;
break;
case INSPECT:
permissionType=PermissionType.READ;
break;
default :
permissionType=PermissionType.OTHER;
break;
}
boolean isQualified=securityService.isUserQualifiedForOperationOnCeilingEntity(persistentAdminUser,permissionType,ceilingEntityFullyQualifiedName);
if (!isQualified) {
SecurityServiceException ex=new SecurityServiceException("Security Check Failed for entity operation: " + operationType.toString() + " ("+ ceilingEntityFullyQualifiedName+ ")");
if (!securityService.doesOperationExistForCeilingEntity(permissionType,ceilingEntityFullyQualifiedName)) {
if (LOG.isWarnEnabled()) {
LOG.warn("Detected security request for an unregistered ceiling entity (" + ceilingEntityFullyQualifiedName + "). "+ "As a result, the request failed. Please make sure to configure security for any ceiling entities "+ "referenced via the admin. This is usually accomplished by adding records in the "+ "BLC_ADMIN_PERMISSION_ENTITY table. Note, depending on how the entity in question is used, you "+ "may need to add to BLC_ADMIN_PERMISSION, BLC_ADMIN_ROLE_PERMISSION_XREF and BLC_ADMIN_SEC_PERM_XREF.",ex);
}
}
throw ex;
}
}
