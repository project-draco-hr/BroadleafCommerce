{
  Order order=orderDao.create();
  order.setCustomer(createCustomer());
  order.setFulfillmentGroups(createFulfillmentGroups("standard",5D));
  order.addOrderItem(createDiscreteOrderItem(123456L,100D,null,true,2));
  order.addAddedOfferCode(createOfferCode("20 Percent Off Item Offer",OfferType.ORDER_ITEM,OfferDiscountType.PERCENT_OFF,20,null,"discreteOrderItem.sku.id == 123456",false,true,10));
  order.addAddedOfferCode(createOfferCode("30 Dollars Off Item Offer",OfferType.ORDER_ITEM,OfferDiscountType.AMOUNT_OFF,30,null,"discreteOrderItem.sku.id == 123456",true,true,1));
  List<Offer> offers=offerService.buildOfferListForOrder(order);
  offerService.applyOffersToOrder(offers,order);
  assert(order.getSubTotal().equals(new Money(140D)));
}
