{
  try {
    List<SellableItem> sellableItems=catalogService.readAllSellableItems();
    if (sellableItems != null) {
      File indexDir=new File("/temp/search/lucene");
      if (!indexDir.exists()) {
        indexDir.mkdir();
      }
      MaxFieldLength mfl=new MaxFieldLength(IndexWriter.DEFAULT_MAX_FIELD_LENGTH);
      IndexWriter writer=new IndexWriter(indexDir,new StandardAnalyzer(),true,mfl);
      for (Iterator<SellableItem> itr=sellableItems.iterator(); itr.hasNext(); ) {
        SellableItem item=itr.next();
        Document doc=new Document();
        doc.add(new Field("ID",item.getId().toString(),Field.Store.YES,Field.Index.NO));
        doc.add(new Field("name",item.getName(),Field.Store.YES,Field.Index.ANALYZED));
        doc.add(new Field("price",item.getPrice() + "",Field.Store.YES,Field.Index.ANALYZED));
        writer.addDocument(doc);
      }
      writer.close();
    }
  }
 catch (  CorruptIndexException e) {
    e.printStackTrace();
  }
catch (  LockObtainFailedException e) {
    e.printStackTrace();
  }
catch (  IOException e) {
    e.printStackTrace();
  }
}
