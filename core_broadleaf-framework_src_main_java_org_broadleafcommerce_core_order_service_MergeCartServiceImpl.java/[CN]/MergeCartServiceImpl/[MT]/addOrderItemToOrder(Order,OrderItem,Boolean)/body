{
  List<OrderItem> orderItems=order.getOrderItems();
  newOrderItem.setOrder(order);
  newOrderItem=orderItemService.saveOrderItem(newOrderItem);
  orderItems.add(newOrderItem);
  if (!LegacyOrderService.class.isAssignableFrom(orderService.getClass())) {
    FulfillmentGroupItemRequest fgItemRequest=new FulfillmentGroupItemRequest();
    fgItemRequest.setFulfillmentGroup(null);
    fgItemRequest.setOrderItem(newOrderItem);
    fgItemRequest.setOrder(order);
    fgItemRequest.setQuantity(newOrderItem.getQuantity());
    fulfillmentGroupService.addItemToFulfillmentGroup(fgItemRequest,false);
  }
  order=orderService.save(order,priceOrder);
  return newOrderItem;
}
