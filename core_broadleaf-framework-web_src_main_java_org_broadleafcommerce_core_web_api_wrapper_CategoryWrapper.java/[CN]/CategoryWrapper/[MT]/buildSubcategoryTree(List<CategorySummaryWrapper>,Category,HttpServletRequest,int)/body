{
  CatalogService catalogService=(CatalogService)context.getBean("blCatalogService");
  if (depth <= 0) {
    return wrappers;
  }
  Integer subcategoryLimit=(Integer)request.getAttribute("subcategoryLimit");
  Integer subcategoryOffset=(Integer)request.getAttribute("subcategoryOffset");
  List<Category> subcategories=catalogService.findAllSubCategories(root,subcategoryLimit,subcategoryOffset);
  if (subcategories != null && !subcategories.isEmpty() && wrappers == null) {
    wrappers=new ArrayList<CategorySummaryWrapper>();
  }
  for (  Category c : subcategories) {
    CategoryWrapper subcategoryWrapper=(CategoryWrapper)context.getBean(CategoryWrapper.class.getName());
    subcategoryWrapper.wrap(c,depth - 1,request);
    wrappers.add(subcategoryWrapper);
  }
  return wrappers;
}
