{
  this.categorySummary=(CategorySummaryWrapper)context.getBean(CategorySummaryWrapper.class.getName());
  this.categorySummary.wrap(category,request);
  this.activeStartDate=category.getActiveStartDate();
  this.activeEndDate=category.getActiveEndDate();
  this.url=category.getUrl();
  this.urlKey=category.getUrlKey();
  if (category.getCategoryAttributes() != null && !category.getCategoryAttributes().isEmpty()) {
    categoryAttributes=new ArrayList<CategoryAttributeWrapper>();
    for (    CategoryAttribute attribute : category.getCategoryAttributes()) {
      CategoryAttributeWrapper wrapper=(CategoryAttributeWrapper)context.getBean(CategoryAttributeWrapper.class.getName());
      wrapper.wrap(attribute,request);
      categoryAttributes.add(wrapper);
    }
  }
  Integer productLimit=(Integer)request.getAttribute("productLimit");
  Integer productOffset=(Integer)request.getAttribute("productOffset");
  Integer subcategoryLimit=(Integer)request.getAttribute("subcategoryLimit");
  Integer subcategoryOffset=(Integer)request.getAttribute("subcategoryOffset");
  if (productLimit != null && productOffset == null) {
    productOffset=1;
  }
  if (subcategoryLimit != null && subcategoryOffset == null) {
    subcategoryOffset=1;
  }
  if (productLimit != null && productOffset != null) {
    CatalogService catalogService=(CatalogService)context.getBean("blCatalogService");
    List<Product> productList=catalogService.findProductsForCategory(category,productLimit,productOffset);
    if (productList != null && !productList.isEmpty()) {
      if (products == null) {
        products=new ArrayList<ProductSummaryWrapper>();
      }
      for (      Product p : productList) {
        ProductSummaryWrapper productSummaryWrapper=(ProductSummaryWrapper)context.getBean(ProductSummaryWrapper.class.getName());
        productSummaryWrapper.wrap(p,request);
        products.add(productSummaryWrapper);
      }
    }
  }
  if (subcategoryLimit != null && subcategoryOffset != null) {
    subcategories=buildSubcategoryTree(subcategories,category,request);
  }
}
