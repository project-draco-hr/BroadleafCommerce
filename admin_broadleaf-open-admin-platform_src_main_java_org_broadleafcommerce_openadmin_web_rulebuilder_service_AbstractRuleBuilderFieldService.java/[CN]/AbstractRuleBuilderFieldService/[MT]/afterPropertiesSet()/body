{
  if (applicationContext.containsBean(PersistenceManagerFactory.getPersistenceManagerRef())) {
    PersistenceManager persistenceManager=(PersistenceManager)applicationContext.getBean(PersistenceManagerFactory.getPersistenceManagerRef());
    persistenceManager.setTargetMode(TargetModeType.SANDBOX);
    dynamicEntityDao=persistenceManager.getDynamicEntityDao();
    setFields(new ArrayList<FieldData>());
    boolean contextWasNull=false;
    if (BroadleafRequestContext.getBroadleafRequestContext() == null) {
      BroadleafRequestContext brc=new BroadleafRequestContext();
      brc.setIgnoreSite(true);
      BroadleafRequestContext.setBroadleafRequestContext(brc);
      contextWasNull=true;
    }
    try {
      init();
      if (extensionManager != null) {
        extensionManager.getProxy().modify(fields,getName());
      }
    }
  finally {
      if (contextWasNull) {
        BroadleafRequestContext.setBroadleafRequestContext(null);
      }
    }
  }
}
