{
  if (!xssProtectionEnabled || StringUtils.isEmpty(string)) {
    return string;
  }
  try {
    CleanResults results=as.scan(string,antiSamyPolicy);
    if (results.getNumberOfErrors() > 0) {
      throw new CleanStringException(results);
    }
    return results.getCleanHTML();
  }
 catch (  CleanStringException e) {
    throw e;
  }
catch (  Exception e) {
    LOG.error("Unable to clean the passed in entity values",e);
    throw new ServiceException("Unable to clean the passed in entity values",e);
  }
}
