{
  if (itemsIterator.hasNext()) {
    stage1=true;
    itemsIterator.next().invoke();
  }
 else   if (supplementalItemsIterator != null && supplementalItemsIterator.hasNext()) {
    stage2=true;
    supplementalItemsIterator.next().invoke();
  }
 else {
    BatchManager batchManager=BatchManager.getInstance();
    if (!batchManager.getBatchPackages().isEmpty()) {
      batchManager.executeBatchRPC(new BatchSuccessHandler(){
        @Override public void onSuccess(){
          if (supplementalItemsIterator == null) {
            supplementalItemsIterator=supplementalItems.iterator();
          }
          if (supplementalItemsIterator.hasNext()) {
            next();
          }
 else {
            presenter.postSetup(canvas);
          }
        }
      }
);
    }
 else {
      presenter.postSetup(canvas);
    }
  }
}
