{
  for (  Property property : entity.getProperties()) {
    String attributeName=property.getName();
    if (property.getValue() != null && dataSource.getField(attributeName).getType().equals(FieldType.DATETIME)) {
      record.setAttribute(attributeName,formatter.parse(property.getValue()));
    }
 else     if (dataSource.getField(attributeName).getType().equals(FieldType.BOOLEAN) && property.getValue() == null && dataSource.getField(attributeName).getRequired()) {
      record.setAttribute(attributeName,false);
    }
 else     if (property.getType() != null && SupportedFieldType.valueOf(property.getType()).equals(SupportedFieldType.FOREIGN_KEY)) {
      record.setAttribute(attributeName,linkedValue);
    }
 else {
      String propertyValue;
      if (property.getName().equals("id")) {
        if (updateId) {
          propertyValue=property.getValue() + "_" + loadLevelCount;
          loadLevelCount++;
          record.setAttribute("id",propertyValue);
        }
      }
 else {
        propertyValue=property.getValue();
        record.setAttribute(attributeName,propertyValue);
      }
    }
  }
  String entityType=entity.getType();
  record.setAttribute("type",entityType);
  return record;
}
