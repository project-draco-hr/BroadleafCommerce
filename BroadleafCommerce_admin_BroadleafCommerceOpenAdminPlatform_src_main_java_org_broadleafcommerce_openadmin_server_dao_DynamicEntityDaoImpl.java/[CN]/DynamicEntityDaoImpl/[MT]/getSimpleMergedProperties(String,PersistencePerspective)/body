{
  Class<?>[] entityClasses=getAllPolymorphicEntitiesFromCeiling(Class.forName(entityName));
  if (!ArrayUtils.isEmpty(entityClasses)) {
    Map<String,FieldMetadata> mergedProperties=getMergedProperties(entityName,entityClasses,(ForeignKey)persistencePerspective.getPersistencePerspectiveItems().get(PersistencePerspectiveItemType.FOREIGNKEY),persistencePerspective.getAdditionalNonPersistentProperties(),persistencePerspective.getAdditionalForeignKeys(),MergedPropertyType.PRIMARY,persistencePerspective.getPopulateToOneFields(),persistencePerspective.getIncludeFields(),persistencePerspective.getExcludeFields(),persistencePerspective.getConfigurationKey(),"");
    return mergedProperties;
  }
 else {
    Map<String,FieldMetadata> mergedProperties=new HashMap<String,FieldMetadata>();
    Class<?> targetClass=Class.forName(entityName);
    Map<String,FieldPresentationAttributes> attributesMap=getFieldPresentationAttributes(targetClass);
    for (    String property : attributesMap.keySet()) {
      FieldPresentationAttributes presentationAttributes=attributesMap.get(property);
      if (!presentationAttributes.getExcluded()) {
        Field field=getSingleField(targetClass,property);
        if (!Modifier.isStatic(field.getModifiers())) {
          buildProperty(targetClass,null,new ForeignKey[]{},MergedPropertyType.PRIMARY,null,mergedProperties,null,"",property,null,false,0,presentationAttributes,presentationAttributes.getExplicitFieldType(),field.getType());
        }
      }
    }
    return mergedProperties;
  }
}
