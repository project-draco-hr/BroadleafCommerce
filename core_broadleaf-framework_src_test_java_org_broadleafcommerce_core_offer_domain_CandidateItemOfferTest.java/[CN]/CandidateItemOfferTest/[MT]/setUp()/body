{
  OfferDataItemProvider dataProvider=new OfferDataItemProvider();
  CandidateItemOfferImpl candidate=new CandidateItemOfferImpl();
  Category category1=new CategoryImpl();
  category1.setName("test1");
  category1.setId(1L);
  Product product1=new ProductImpl();
  Sku sku1=new SkuImpl();
  sku1.setName("test1");
  sku1.setDiscountable(true);
  sku1.setRetailPrice(new Money(19.99D));
  product1.setDefaultSku(sku1);
  category1.getAllProducts().add(product1);
  Category category2=new CategoryImpl();
  category2.setName("test2");
  category2.setId(2L);
  Product product2=new ProductImpl();
  Sku sku2=new SkuImpl();
  sku2.setName("test2");
  sku2.setDiscountable(true);
  sku2.setRetailPrice(new Money(29.99D));
  product2.setDefaultSku(sku2);
  category2.getAllProducts().add(product2);
  DiscreteOrderItemImpl orderItem1=new DiscreteOrderItemImpl();
  orderItem1.setCategory(category1);
  orderItem1.setName("test1");
  orderItem1.setOrderItemType(OrderItemType.DISCRETE);
  orderItem1.setProduct(product1);
  orderItem1.setQuantity(2);
  orderItem1.setSku(sku1);
  Order order=new OrderImpl();
  orderItem1.setOrder(order);
  promotableOrder=new PromotableOrderImpl(order,new PromotableItemFactoryImpl(),false);
  offer=dataProvider.createItemBasedOfferWithItemCriteria("order.subTotal.getAmount()>20",OfferDiscountType.PERCENT_OFF,"([MVEL.eval(\"toUpperCase()\",\"test1\"), MVEL.eval(\"toUpperCase()\",\"test2\")] contains MVEL.eval(\"toUpperCase()\", discreteOrderItem.category.name))","([MVEL.eval(\"toUpperCase()\",\"test1\"), MVEL.eval(\"toUpperCase()\",\"test2\")] contains MVEL.eval(\"toUpperCase()\", discreteOrderItem.category.name))").get(0);
  candidateOffer=new PromotableCandidateItemOfferImpl(promotableOrder,offer);
  promotableOrderItem=new PromotableOrderItemImpl(orderItem1,null,new PromotableItemFactoryImpl(),false);
  OrderItemPriceDetail pdetail=new OrderItemPriceDetailImpl();
  pdetail.setOrderItem(orderItem1);
  pdetail.setQuantity(2);
  priceDetail=new PromotableOrderItemPriceDetailImpl(promotableOrderItem,2);
  List<PromotableOrderItem> items=new ArrayList<PromotableOrderItem>();
  items.add(promotableOrderItem);
  promotableCandidate=new PromotableCandidateItemOfferImpl(promotableOrder,offer);
  promotableCandidate.getCandidateTargets().addAll(items);
}
