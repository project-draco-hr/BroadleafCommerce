{
  try {
    Order order=promotableOrder.getDelegate();
    if (!CollectionUtils.isEmpty(order.getFulfillmentGroups())) {
      List<OrderMultishipOption> options=orderMultishipOptionService.findOrderMultishipOptions(order.getId());
      promotableOrder.setMultiShipOptions(options);
      promotableOrder.setHasMultiShipOptions(!CollectionUtils.isEmpty(options) && order.getFulfillmentGroups().size() > 1);
      fulfillmentGroupService.collapseToOneFulfillmentGroup(order,false);
      order.getFulfillmentGroups().get(0).setAddress(null);
      order.getFulfillmentGroups().get(0).setFulfillmentOption(null);
    }
  }
 catch (  PricingException e) {
    throw new RuntimeException("Could not prepare the cart",e);
  }
}
