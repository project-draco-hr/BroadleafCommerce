{
  List<FulfillmentOption> fulfillmentOptions=fulfillmentOptionService.readAllFulfillmentOptions();
  Order cart=CartState.getCart();
  if (!(cart instanceof NullOrderImpl) && cart.getFulfillmentGroups().size() > 0 && hasValidShippingAddresses(cart)) {
    Set<FulfillmentOption> options=new HashSet<FulfillmentOption>();
    options.addAll(fulfillmentOptions);
    FulfillmentEstimationResponse estimateResponse=null;
    try {
      estimateResponse=fulfillmentPricingService.estimateCostForFulfillmentGroup(fulfillmentGroupService.getFirstShippableFulfillmentGroup(cart),options);
    }
 catch (    FulfillmentPriceException e) {
    }
    model.addAttribute("estimateResponse",estimateResponse);
  }
  model.addAttribute("fulfillmentOptions",fulfillmentOptions);
}
