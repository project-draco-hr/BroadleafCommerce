{
  if (jsonListProvider == null) {
    jsonListProvider=new JSONListElementProvider.App(ps);
  }
  if (xmlListProvider == null) {
    xmlListProvider=new XMLListElementProvider.App(xif,ps);
  }
  if (mediaType.isCompatible(MediaType.APPLICATION_JSON_TYPE)) {
    if (Collection.class.isAssignableFrom(type)) {
      return jsonListProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
 else {
      return jsonRootElementProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
  }
 else   if (mediaType.isCompatible(MediaType.APPLICATION_XML_TYPE) || mediaType.isCompatible(MediaType.TEXT_XML_TYPE)) {
    if (Collection.class.isAssignableFrom(type)) {
      return xmlListProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
 else {
      return xmlRootElementProvider.readFrom(type,genericType,annotations,mediaType,httpHeaders,entityStream);
    }
  }
  return null;
}
