{
  Map<String,FieldMetadata> attributes=new HashMap<String,FieldMetadata>();
  Field[] fields=getAllFields(targetClass);
  for (  Field field : fields) {
    AdminPresentation annot=field.getAnnotation(AdminPresentation.class);
    AdminPresentationCollection annotColl=field.getAnnotation(AdminPresentationCollection.class);
    AdminPresentationAdornedTargetCollection adornedTargetCollection=field.getAnnotation(AdminPresentationAdornedTargetCollection.class);
    AdminPresentationMap map=field.getAnnotation(AdminPresentationMap.class);
    if (annot != null) {
      buildBasicMetadata(attributes,field,annot);
    }
 else     if (annotColl != null) {
      buildCollectionMetadata(targetClass,attributes,field,annotColl);
    }
 else     if (adornedTargetCollection != null) {
      buildAdornedTargetCollectionMetadata(targetClass,attributes,field,adornedTargetCollection);
    }
 else     if (map != null) {
      buildMapMetadata(targetClass,attributes,field,map);
    }
 else {
      BasicFieldMetadata metadata=new BasicFieldMetadata();
      metadata.setName(field.getName());
      metadata.setExcluded(false);
      attributes.put(field.getName(),metadata);
    }
  }
  return attributes;
}
