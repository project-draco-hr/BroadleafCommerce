{
  Class<?>[] polymorphicEntities=getAllPolymorphicEntitiesFromCeiling(returnedClass);
  List<Class<?>> clonedParentClasses=new ArrayList<Class<?>>();
  for (  Class<?> parentClass : parentClasses) {
    clonedParentClasses.add(parentClass);
  }
  clonedParentClasses.add(targetClass);
  Map<String,FieldMetadata> newFields=getMergedPropertiesRecursively(ceilingEntityFullyQualifiedClassname,polymorphicEntities,foreignField,additionalNonPersistentProperties,additionalForeignFields,MergedPropertyType.PRIMARY,populateManyToOneFields,includeFields,excludeFields,configurationKey,clonedParentClasses,prefix + propertyName + '.',isParentExcluded);
  for (  FieldMetadata newMetadata : newFields.values()) {
    newMetadata.setInheritedFromType(targetClass.getName());
    newMetadata.setAvailableToTypes(new String[]{targetClass.getName()});
  }
  Map<String,FieldMetadata> convertedFields=new HashMap<String,FieldMetadata>(newFields.size());
  for (  Map.Entry<String,FieldMetadata> key : newFields.entrySet()) {
    convertedFields.put(propertyName + '.' + key.getKey(),key.getValue());
  }
  fields.putAll(convertedFields);
}
