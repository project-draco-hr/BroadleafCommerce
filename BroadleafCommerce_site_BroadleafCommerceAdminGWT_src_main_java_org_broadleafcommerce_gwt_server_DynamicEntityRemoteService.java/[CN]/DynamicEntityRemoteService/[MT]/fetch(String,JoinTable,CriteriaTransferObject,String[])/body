{
  Entity[] payload;
  int totalRecords;
  try {
    Class<?>[] entities=getPolymorphicEntities(ceilingEntityFullyQualifiedClassname);
    Map<String,FieldMetadata> mergedPropertiesTarget=getMergedProperties(ceilingEntityFullyQualifiedClassname,entities,new ForeignKey[]{},additionalNonPersistentProperties);
    Map<String,FieldMetadata> mergedProperties=getMergedProperties(joinTable.getJoinTableEntityClassname(),new Class[]{Class.forName(joinTable.getJoinTableEntityClassname())},new ForeignKey[]{},new String[]{});
    BaseCtoConverter ctoConverter=getAlternateCtoConverter(cto,mergedProperties,joinTable);
    PersistentEntityCriteria queryCriteria=ctoConverter.convert(cto,joinTable.getJoinTableEntityClassname());
    List<Serializable> records=dynamicEntityDao.query(queryCriteria,Class.forName(joinTable.getJoinTableEntityClassname()));
    payload=getRecords(mergedPropertiesTarget,records,joinTable.getAssociationPathToTargetObject());
    totalRecords=getTotalRecords(joinTable.getJoinTableEntityClassname(),cto,ctoConverter);
  }
 catch (  Exception e) {
    LOG.error("Problem fetching results for " + joinTable.getJoinTableEntityClassname(),e);
    throw new ServiceException("Unable to fetch results for " + joinTable.getJoinTableEntityClassname(),e);
  }
  DynamicResultSet results=new DynamicResultSet(null,payload,totalRecords);
  return results;
}
