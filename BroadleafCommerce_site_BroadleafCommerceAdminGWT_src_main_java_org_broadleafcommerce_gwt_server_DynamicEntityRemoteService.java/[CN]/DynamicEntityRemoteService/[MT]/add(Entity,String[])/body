{
  try {
    List<Class<?>> entities=getPolymorphicEntities(entity.getType());
    Map<String,FieldMetadata> mergedProperties=getMergedProperties(entity.getType(),entities,optionalFields);
    Serializable instance=(Serializable)Class.forName(entity.getType()).newInstance();
    instance=createPopulatedInstance(instance,entity,mergedProperties);
    instance=genericDao.persist(instance);
    List<Serializable> entityList=new ArrayList<Serializable>();
    entityList.add(instance);
    return getRecords(mergedProperties,entityList)[0];
  }
 catch (  Exception e) {
    LOG.error("Problem adding new entity",e);
    throw new ServiceException("Problem adding new entity",e);
  }
}
