{
  try {
    List<Class<?>> entities=getPolymorphicEntities(entity.getType());
    Map<String,FieldMetadata> mergedProperties=getMergedProperties(entity.getType(),entities,null);
    String idProperty=null;
    for (    String property : mergedProperties.keySet()) {
      if (mergedProperties.get(property).getFieldType().equals(SupportedFieldType.ID)) {
        idProperty=property;
        break;
      }
    }
    if (idProperty == null) {
      throw new RuntimeException("Could not find a primary key property in the passed entity with type: " + entity.getType());
    }
    Object primaryKey=null;
    for (    Property property : entity.getProperties()) {
      if (property.getName().equals(idProperty)) {
        primaryKey=Long.valueOf(property.getValue());
      }
    }
    if (primaryKey == null) {
      throw new RuntimeException("Could not find the primary key property (" + idProperty + ") in the passed entity with type: "+ entity.getType());
    }
    Serializable instance=genericDao.retrieve(Class.forName(entity.getType()),primaryKey);
    genericDao.remove(instance);
  }
 catch (  Exception e) {
    LOG.error("Problem removing entity",e);
    throw new ServiceException("Problem removing entity",e);
  }
}
