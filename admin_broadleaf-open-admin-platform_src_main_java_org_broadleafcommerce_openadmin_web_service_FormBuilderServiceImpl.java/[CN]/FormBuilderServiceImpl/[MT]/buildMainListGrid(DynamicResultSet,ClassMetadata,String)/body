{
  List<Field> headerFields=new ArrayList<Field>();
  ListGrid.Type type=ListGrid.Type.MAIN;
  String idProperty="id";
  for (  Property p : cmd.getProperties()) {
    if (p.getMetadata() instanceof BasicFieldMetadata) {
      BasicFieldMetadata fmd=(BasicFieldMetadata)p.getMetadata();
      if (SupportedFieldType.ID.equals(fmd.getFieldType())) {
        idProperty=fmd.getName();
      }
      if (fmd.isProminent() != null && fmd.isProminent() && !VisibilityEnum.HIDDEN_ALL.equals(fmd.getVisibility()) && !VisibilityEnum.GRID_HIDDEN.equals(fmd.getVisibility())) {
        Field hf;
        if (fmd.getFieldType().equals(SupportedFieldType.EXPLICIT_ENUMERATION) || fmd.getFieldType().equals(SupportedFieldType.BROADLEAF_ENUMERATION) || fmd.getFieldType().equals(SupportedFieldType.DATA_DRIVEN_ENUMERATION)|| fmd.getFieldType().equals(SupportedFieldType.EMPTY_ENUMERATION)) {
          hf=new ComboField();
          ((ComboField)hf).setOptions(fmd.getEnumerationValues());
        }
 else {
          hf=new Field();
        }
        hf.withName(p.getName()).withFriendlyName(fmd.getFriendlyName()).withOrder(fmd.getGridOrder()).withColumnWidth(fmd.getColumnWidth()).withForeignKeyDisplayValueProperty(fmd.getForeignKeyDisplayValueProperty());
        String fieldType=fmd.getFieldType() == null ? null : fmd.getFieldType().toString();
        hf.setFieldType(fieldType);
        headerFields.add(hf);
      }
    }
  }
  ListGrid listGrid=createListGrid(cmd.getCeilingType(),headerFields,type,drs,sectionKey,0,idProperty);
  return listGrid;
}
