{
  ProductSearchCriteria searchCriteria=new ProductSearchCriteria();
  Map<String,String[]> params=new HashMap<String,String[]>(request.getParameterMap());
  for (Iterator<Map.Entry<String,String[]>> iter=params.entrySet().iterator(); iter.hasNext(); ) {
    Map.Entry<String,String[]> entry=iter.next();
    String key=entry.getKey();
    if (key.equals(ProductSearchCriteria.SORT_STRING)) {
      searchCriteria.setSortQuery(entry.getValue()[0]);
      iter.remove();
    }
    if (key.equals(ProductSearchCriteria.PAGE_NUMBER)) {
      searchCriteria.setPage(Integer.parseInt(entry.getValue()[0]));
      iter.remove();
    }
    if (key.equals(ProductSearchCriteria.PAGE_SIZE_STRING)) {
      searchCriteria.setPageSize(Integer.parseInt(entry.getValue()[0]));
      iter.remove();
    }
    if (key.equals(ProductSearchCriteria.QUERY_STRING)) {
      iter.remove();
    }
  }
  searchCriteria.setFilterCriteria(params);
  return searchCriteria;
}
